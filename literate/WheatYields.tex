
\documentclass{report}
\usepackage{amsmath}

\usepackage{Sweave}
\begin{document}

\title{Geospatial analysis of yield trends in winter wheat}\author{Peter Claussen}\maketitle


\begin{Schunk}
\begin{Sinput}
> source("../ASA_CSSA_SSSA/R/map_functions.R")
> 
\end{Sinput}
\end{Schunk}

We drive the analysis from the USDA data set for yield. These data are in the \verb|usda| directory.
The majority of files are fit with code in that directory, and we will store our covariate data there as well.

The various \verb|fitLinearModels.Snw| will follow a general structure. Each covariate will be fit to a simple linear model by year, and the result saved
as an Rda file. If a file (or controlling file) is not present, the appropriate data set is read. In some cases, the data are processed (i.e. to remove commas as thousand separators), and the resulting Rda file may be read instead. This in general speeds analysis, since in many cases fitting linear models is time consuming. In this controlling code, we save the intermediate covariate files and load linear models only when certain covariate headers are not found.


\begin{Schunk}
\begin{Sinput}
> setwd('data/usda/')
> load.if.needed("county.yield.dat")
> setwd(current.wd)
> county.yield.dat$State <- as.character(county.yield.dat$State)
> county.yield.dat$State[county.yield.dat$State=="SOUTH DAKOTA"] <- "SD"
> county.yield.dat$State[county.yield.dat$State=="NORTH DAKOTA"] <- "ND"
> county.yield.dat$State[county.yield.dat$State=="NEBRASKA"] <- "NE"
> county.yield.dat$State[county.yield.dat$State=="KANSAS"] <- "KS"
> county.yield.dat$State[county.yield.dat$State=="OKLAHOMA"] <- "OK"
> county.yield.dat$State[county.yield.dat$State=="TEXAS"] <- "TX"
> county.yield.dat$State <- as.factor(county.yield.dat$State)
> county.yield.plot <- ggplot(county.yield.dat, aes(Year,Value)) + theme_bw() + labs(y="Yield, bu/acre",title="County Yield Average over Time")
> county.yield.plot <- county.yield.plot + scale_fill_manual(values=fullPalette) + scale_colour_manual(values=fullPalette)
> county.yield.plot <- county.yield.plot + geom_point(aes(color=State),size=1,alpha = 0.2)
> county.yield.plot <- county.yield.plot + geom_smooth(aes(group= State,color=State,linetype=State),size=2,se = FALSE,method="loess")
> county.yield.plot
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-centralyear}

\begin{Schunk}
\begin{Sinput}
> setwd('data/usda/')
> load.if.needed("full.yield.dat")
> setwd(current.wd)
> full.yield.dat <- subset(full.yield.dat,!(full.yield.dat$State %in% c("washington","idaho")))
> full.yield.plot <- ggplot(full.yield.dat, aes(Year,Value)) + theme_bw() + ylim(0,150) +
+   scale_fill_manual(values=fullPalette) + scale_colour_manual(values=fullPalette) + 
+   geom_point(aes(color=State),size=2,alpha = 0.2) + geom_smooth(aes(group= State,color=State,linetype=State),weight=24,se = FALSE,method="loess") +
+   labs(x="Year",y="Yield, bu/acre")
> full.yield.plot
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-fullyear}


\begin{Schunk}
\begin{Sinput}
> yield1984.dat <- subset(full.yield.dat,full.yield.dat$Year==1984)
> yield2014.dat <- subset(full.yield.dat,full.yield.dat$Year==2014)
> grid.arrange(arrangeGrob(
+   ggmap.full.values(yield1984.dat$Value,yield1984.dat$statecounty,main="Yield 1984",palette=yield.palette),
+   ggmap.full.values(yield2014.dat$Value,yield2014.dat$statecounty,main="Yield 2014",palette=yield.palette),
+    as.table=TRUE,
+    ncol=2))
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-005}

\begin{Schunk}
\begin{Sinput}
> periph.dat <- subset(full.yield.dat,!(full.yield.dat$State %in% levels(county.yield.dat$State)))
> periph.yield.plot <- ggplot(periph.dat, aes(Year,Value)) + theme_bw() + ylim(0,150) + 
+   scale_fill_manual(values=fullPalette) + scale_colour_manual(values=fullPalette) + 
+   geom_point(aes(color=State),size=2,alpha = 0.2) + geom_smooth(aes(group= State,color=State,linetype=State),weight=24,se = FALSE,method="loess") +
+   labs(x="Year",y="Yield, bu/acre")
> periph.yield.plot
> periph.dat=NULL
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-periphyear}



\section{Covariates}

\subsection{Weather}
\begin{Schunk}
\begin{Sinput}
> if(!("min.a" %in% names(covariates.dat))) {
+    setwd('data/wonder')
+    Sweave("fitLinearModels.Snw")
+    setwd(current.wd)
+ }
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> if(!("min.a" %in% names(full.covariates.dat))) {
+    setwd('data/wonder')
+    Sweave("fitLinearModels.Snw")
+    setwd(current.wd)
+ }
\end{Sinput}
\end{Schunk}
\subsection{Nutrients} 

See \verb|data\IPNI| for more discussion of this data.

\begin{Schunk}
\begin{Sinput}
> if(!("Farm_TonsN.a" %in% names(covariates.dat))) {
+    setwd('data/ipni')
+    Sweave("fitLinearModels.Snw")
+    setwd(current.wd)
+ }
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> if(!("Farm_TonsN.a" %in% names(full.covariates.dat))) {
+    setwd('data/ipni')
+    Sweave("fitLinearModels.Snw")
+    setwd(current.wd)
+ }
\end{Sinput}
\end{Schunk}

Other measures
\begin{Schunk}
\begin{Sinput}
> if(!("harvested.a" %in% names(covariates.dat))) {
+    setwd('data/usda/')
+    if(!file.exists("harvested.late.county.lm.Rda")) {
+       Sweave("fitLinearModels.Snw")
+    } else {
+       load(file="harvested.late.county.lm.Rda")
+       load(file="acres.late.county.lm.Rda")
+       #load(file="income.total.county.lm.Rda")
+       #load(file="income.relative.county.lm.Rda")
+    }
+    setwd(current.wd)
+ 
+    covariates.dat$harvested.a <- extract.county.estimates(harvested.late.county.lm,term=1)[coef.idx]
+    covariates.dat$harvested.b <- extract.county.estimates(harvested.late.county.lm,term=2)[coef.idx]
+ 
+    covariates.dat$acres.a <- extract.county.estimates(acres.late.county.lm,term=1)[coef.idx]
+    covariates.dat$acres.b <- extract.county.estimates(acres.late.county.lm,term=2)[coef.idx]
+ 
+    #covariates.dat$relative.a <- extract.county.estimates(income.relative.county.lm,term=1)[coef.idx]
+    #covariates.dat$relative.b <- extract.county.estimates(income.relative.county.lm,term=2)[coef.idx]
+    
+    #covariates.dat$total.a <- extract.county.estimates(income.total.county.lm,term=1)[coef.idx]
+    #covariates.dat$total.b <- extract.county.estimates(income.total.county.lm,term=2)[coef.idx]   
+    save(covariates.dat, file=covariateFileName)
+ }
> if(!("harvested.a" %in% names(full.covariates.dat))) {
+    setwd('data/usda/')
+    if(!file.exists("harvested.late.full.lm.Rda")) {
+       Sweave("fitLinearModels.Snw")
+    } else {
+       load.if.needed("harvested.late.county.lm")
+       load.if.needed("harvested.late.full.lm")
+       load.if.needed("acres.late.county.lm")
+       load.if.needed("acres.late.full.lm")
+       #load.if.needed("income.total.county.lm")
+       #load.if.needed("full.income.total.county.lm")
+       #load.if.needed("income.relative.county.lm")
+       #load.if.needed("full.income.relative.county.lm")
+    }
+    setwd(current.wd)
+ 
+    estimates <- c(extract.county.estimates(harvested.late.county.lm,term=1),
+                  extract.county.estimates(harvested.late.full.lm,term=1))
+    full.covariates.dat$harvested.a <- estimates[full.coef.idx]
+    estimates <- c(extract.county.estimates(harvested.late.county.lm,term=2),
+                  extract.county.estimates(harvested.late.full.lm,term=2))
+    full.covariates.dat$harvested.b <- estimates[full.coef.idx]
+ 
+    estimates <- c(extract.county.estimates(acres.late.county.lm,term=1),
+                  extract.county.estimates(acres.late.full.lm,term=1))
+    full.covariates.dat$acres.a <- estimates[full.coef.idx]
+    estimates <- c(extract.county.estimates(acres.late.county.lm,term=2),
+                  extract.county.estimates(acres.late.full.lm,term=2))
+    full.covariates.dat$acres.b <- estimates[full.coef.idx]
+     
+    save(full.covariates.dat, file=covariateFullFileName)
+ }
> setwd(current.wd)
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> grid.arrange(arrangeGrob(
+   ggmap.full.values(full.covariates.dat$harvested.a,full.covariates.dat$statecounty,main="Harvested Average",legend="mean",palette=yield.palette),
+   ggmap.full.values(full.covariates.dat$harvested.b,full.covariates.dat$statecounty,main="Harvested Change",legend="%/yr",palette=yield.palette),
+    as.table=TRUE,
+    ncol=2))
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-012}

Check work
\begin{Schunk}
\begin{Sinput}
> setwd(current.wd)
> setwd('data/usda/')
> load.if.needed("harvested.late.county.lm")
> load.if.needed("county.harvested.dat")
> setwd(current.wd)
> harvested.a <- extract.county.estimates(harvested.late.county.lm,term=1)[coef.idx]
> harvested.b <- extract.county.estimates(harvested.late.county.lm,term=2)[coef.idx]
> plot(hist(harvested.a))
> harvested.lsmean <- harvested.a + 1980*harvested.b
> plot(hist(harvested.lsmean))
> harvested.lsmean <- harvested.a + 1999*harvested.b
> plot(hist(harvested.lsmean))
> head(county.harvested.dat)
\end{Sinput}
\begin{Soutput}
  Program Year Period Week.Ending Geo.Level  State State.ANSI Ag.District
1  SURVEY 2014   YEAR          NA    COUNTY KANSAS         20     CENTRAL
2  SURVEY 2014   YEAR          NA    COUNTY KANSAS         20     CENTRAL
3  SURVEY 2014   YEAR          NA    COUNTY KANSAS         20     CENTRAL
4  SURVEY 2014   YEAR          NA    COUNTY KANSAS         20     CENTRAL
5  SURVEY 2014   YEAR          NA    COUNTY KANSAS         20     CENTRAL
6  SURVEY 2014   YEAR          NA    COUNTY KANSAS         20     CENTRAL
  Ag.District.Code    County County.ANSI Zip.Code Region watershed_code
1               50    BARTON           9       NA     NA              0
2               50 DICKINSON          41       NA     NA              0
3               50     ELLIS          51       NA     NA              0
4               50 ELLSWORTH          53       NA     NA              0
5               50   LINCOLN         105       NA     NA              0
6               50    MARION         115       NA     NA              0
  Watershed Commodity                       Data.Item Domain Domain.Category
1        NA     WHEAT WHEAT, WINTER - ACRES HARVESTED  TOTAL   NOT SPECIFIED
2        NA     WHEAT WHEAT, WINTER - ACRES HARVESTED  TOTAL   NOT SPECIFIED
3        NA     WHEAT WHEAT, WINTER - ACRES HARVESTED  TOTAL   NOT SPECIFIED
4        NA     WHEAT WHEAT, WINTER - ACRES HARVESTED  TOTAL   NOT SPECIFIED
5        NA     WHEAT WHEAT, WINTER - ACRES HARVESTED  TOTAL   NOT SPECIFIED
6        NA     WHEAT WHEAT, WINTER - ACRES HARVESTED  TOTAL   NOT SPECIFIED
   Value CV....      statecounty
1 156900     NA    kansas,barton
2 139220     NA kansas,dickinson
3  93800     NA     kansas,ellis
4  79600     NA kansas,ellsworth
5  94430     NA   kansas,lincoln
6 137800     NA    kansas,marion
\end{Soutput}
\begin{Sinput}
> harvested.mean <- tapply(county.harvested.dat$Value,list(county.harvested.dat$statecounty),mean,na.rm=TRUE)
> plot(hist(harvested.mean))
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> har1984.dat <- subset(county.harvested.dat,county.harvested.dat$Year==1984)
> har2014.dat <- subset(county.harvested.dat,county.harvested.dat$Year==2013)
> grid.arrange(arrangeGrob(
+   ggmap.full.values(har1984.dat$Value,har1984.dat$statecounty,main="Harvested 1984",palette=yield.palette),
+   ggmap.full.values(har2014.dat$Value,har2014.dat$statecounty,main="Harvested 2014",palette=yield.palette),
+    as.table=TRUE,
+    ncol=2))
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-014}
   
\begin{Schunk}
\begin{Sinput}
> harvested.mean <- harvested.mean[names(harvested.lsmean)]
> plot(harvested.mean,harvested.lsmean)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-015}

\begin{Schunk}
\begin{Sinput}
> harvested.lsmean <- covariates.dat$harvested.a + covariates.dat$harvested.b*ref
> names(harvested.lsmean) <- as.character(covariates.dat$statecounty)
> plot(harvested.mean[as.character(covariates.dat$statecounty)],harvested.lsmean[as.character(covariates.dat$statecounty)])
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-016}

\verb|"INCOME, NET CASH FARM, OF OPERATIONS - NET INCOME, MEASURED IN $ / OPERATION"|


\section{Covariate Analysis}
Map yield parameters to the covariate data set. We need to fit yield changes
Now we actually analyze county yield data. Note we need to redo subset since we've since
appended statecounty index



\begin{Schunk}
\begin{Sinput}
> cols <- dim(covariates.dat)[2]
> intercept.columns <- 2*(1:((dim(covariates.dat)[2]/2)-1))+1
> covariates.dat[,intercept.columns] <- covariates.dat[,intercept.columns]+ covariates.dat[,intercept.columns+1]*ref
> intercept.names <- names(covariates.dat)[intercept.columns]
> yield.idx <- 3
> #normalize to percent
> covariates.dat[,intercept.columns+1] <- 100*covariates.dat[,intercept.columns+1]/covariates.dat[,intercept.columns]
> #three counties with negative ls means, and some counties have a small number of acres, this is arbitrary
> covariates.dat <- subset(covariates.dat,covariates.dat$harvested.a>200)
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> cols <- dim(full.covariates.dat)[2]
> full.intercept.columns <- 2*(1:((dim(full.covariates.dat)[2]/2)-1))+1
> names(full.covariates.dat)[full.intercept.columns]
\end{Sinput}
\begin{Soutput}
 [1] "yield.a"                          "Farm_TonsN.a"                    
 [3] "Farm_TonsP.a"                     "Farm_TonsK.a"                    
 [5] "Tons_N_Exc.a"                     "Tons_P2O5_Exc.a"                 
 [7] "Tons_K2O_Exc.a"                   "Tons_N_Recovered.a"              
 [9] "Tons_P2O5_Recovered.a"            "Tons_K2O_Recovered.a"            
[11] "Tons_N_Fixed_Legumes.a"           "Tons_N_Rem.a"                    
[13] "Tons_P2O5_Rem.a"                  "Tons_K2O_Rem.a"                  
[15] "BalanceN_Tons.a"                  "BalanceP2O5_Tons.a"              
[17] "BalanceK2O_Tons.a"                "RatioN.a"                        
[19] "RatioP2O5.a"                      "RatioK2O.a"                      
[21] "N_PPCA.a"                         "P2O5_PPCA.a"                     
[23] "K2O_PPCA.a"                       "FarmNPPCA.a"                     
[25] "FarmPPPCA.a"                      "FarmKPPCA.a"                     
[27] "X21Crop_TotalPlantedAc.a"         "X21Crop_TotalHarvestAc.a"        
[29] "Total_Harvested_Cropland_Acres.a" "TotalCropland.a"                 
[31] "min.a"                            "max.a"                           
[33] "heat.a"                           "precip.a"                        
[35] "sun.a"                            "day.a"                           
[37] "night.a"                          "fine.a"                          
[39] "harvested.a"                      "acres.a"                         
\end{Soutput}
\begin{Sinput}
> full.covariates.dat[,full.intercept.columns] <- full.covariates.dat[,full.intercept.columns]+ full.covariates.dat[,full.intercept.columns+1]*ref
> full.covariates.dat[,full.intercept.columns+1] <- 100*full.covariates.dat[,full.intercept.columns+1]/full.covariates.dat[,full.intercept.columns]
\end{Sinput}
\end{Schunk}


\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$harvested.a,full.covariates.dat$statecounty,main="harvested.a",legend="mean",palette=yield.palette)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-019}

This removes mostly iowa counties
\begin{Schunk}
\begin{Sinput}
> plot(hist(full.covariates.dat$harvested.a))
> full.covariates.dat <- subset(full.covariates.dat,full.covariates.dat$harvested.a > 200)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-020}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$harvested.a,full.covariates.dat$statecounty,main="harvested.a subset",legend="mean",palette=yield.palette)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-021}

\begin{Schunk}
\begin{Sinput}
> plot(hist(full.covariates.dat$acres.b))
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-022}


%full.covariates.dat <- subset(full.covariates.dat,abs(full.covariates.dat$acres.b)>100)



\begin{Schunk}
\begin{Sinput}
> yield.b.map <- make.map.data(full.covariates.dat$yield.b,full.covariates.dat$statecounty)
> map.means<-tapply(yield.b.map$values,list(yield.b.map$statecounty),mean)
> yield.b <- map.means[as.character(full.covariates.dat$statecounty)]
> names(yield.b) <- as.character(full.covariates.dat$statecounty)
> pooled.names <- names(map.means)
> pooled.names <- pooled.names[pooled.names %in%names(yield.b)]
> yield.b["kansas,allen"]
\end{Sinput}
\begin{Soutput}
kansas,allen 
   0.7210849 
\end{Soutput}
\begin{Sinput}
> map.means["kansas,allen"]
\end{Sinput}
\begin{Soutput}
kansas,allen 
   0.7210849 
\end{Soutput}
\begin{Sinput}
> plot(map.means[pooled.names],yield.b[pooled.names])
\end{Sinput}
\end{Schunk}

There is one outlier for yield change, so remove
\begin{Schunk}
\begin{Sinput}
> plot(hist(full.covariates.dat$yield.b))
> covariates.dat <- subset(covariates.dat,abs(covariates.dat$yield.b)<5)
> full.covariates.dat <- subset(full.covariates.dat,abs(full.covariates.dat$yield.b)<5)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-024}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$yield.b,full.covariates.dat$statecounty,main="yield.b",legend="%",palette=yield.palette)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-025}

\begin{Schunk}
\begin{Sinput}
> setwd('data/usda/')
> #stophammer
> load.if.needed("full.income.relative.dat")
> load.if.needed("income.relative.dat")
> setwd(current.wd)
> full.coef.idx <- as.character(full.covariates.dat$statecounty)
> mean.income1 <- tapply(income.relative.dat$Value,list(income.relative.dat$statecounty),mean,na.rm=TRUE)
> mean.income2 <- tapply(full.income.relative.dat$Value,list(full.income.relative.dat$statecounty),mean,na.rm=TRUE)
> full.covariates.dat$mean.income <- c(mean.income1,mean.income2)[full.coef.idx]
> covariates.dat$mean.income <- c(mean.income1)[as.character(covariates.dat$statecounty)]
\end{Sinput}
\end{Schunk}


\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$mean.income,full.covariates.dat$statecounty,main="Mean Income",legend="$/operation",palette=yield.palette)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-meanincome}


Two counties with outliers for income, but the center in a cluster

\begin{Schunk}
\begin{Sinput}
> plot(hist(full.covariates.dat$mean.income))
> #full.covariates.dat <- subset(full.covariates.dat,full.covariates.dat$mean.income<250000)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-028}

\begin{Schunk}
\begin{Sinput}
> mean(full.covariates.dat$Total_Harvested_Cropland_Acres.a,na.rm=TRUE)
\end{Sinput}
\begin{Soutput}
[1] 168786.2
\end{Soutput}
\begin{Sinput}
> full.covariates.dat$wheat_frac <- 100*full.covariates.dat$harvested.a/full.covariates.dat$Total_Harvested_Cropland_Acres.a
> covariates.dat$wheat_frac <- 100*covariates.dat$harvested.a/covariates.dat$Total_Harvested_Cropland_Acres.a
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$wheat_frac,full.covariates.dat$statecounty,main="Wheat acres, % of total acres",legend="% harvested",palette=yield.palette)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-030}

\section*{HWW RPN}
Before we add spatial statistics, save the current set of columns
\begin{Schunk}
\begin{Sinput}
> covariate.terms <- names(full.covariates.dat)[5:dim(full.covariates.dat)[2]]
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> if(!("Distance" %in% names(covariates.dat))) {
+    setwd('data/wwheat/')
+    Sweave("fitLinearModels.Snw")
+    setwd(current.wd)
+ }
\end{Sinput}
\begin{Soutput}
Writing to file fitLinearModels.tex
Processing code chunks with options ...
 1 : keep.source term verbatim (fitLinearModels.Snw:7)
 2 : echo keep.source term verbatim (fitLinearModels.Snw:17)
 3 : echo keep.source term verbatim (fitLinearModels.Snw:50)
 4 : echo keep.source term verbatim (fitLinearModels.Snw:60)
 5 : echo keep.source term verbatim (fitLinearModels.Snw:93)
 6 : echo keep.source term verbatim (fitLinearModels.Snw:101)
 7 : echo keep.source term verbatim pdf  (fitLinearModels.Snw:127)
 8 : echo keep.source term verbatim pdf  (fitLinearModels.Snw:134)
 9 : echo keep.source term verbatim (fitLinearModels.Snw:143)
10 : echo keep.source term verbatim pdf  (fitLinearModels.Snw:151)
11 : echo keep.source term verbatim pdf  (fitLinearModels.Snw:157)
12 : echo keep.source term verbatim pdf  (fitLinearModels.Snw:163)
13 : echo keep.source term verbatim (fitLinearModels.Snw:169)
14 : echo keep.source term verbatim (fitLinearModels.Snw:177)
15 : echo keep.source term verbatim pdf  (fitLinearModels.Snw:189)
16 : echo keep.source term verbatim pdf  (fitLinearModels.Snw:194)
17 : echo keep.source term verbatim (fitLinearModels.Snw:209)
18 : echo keep.source term verbatim pdf  (fitLinearModels.Snw:251)
19 : echo keep.source term verbatim pdf  (fitLinearModels.Snw:261)
20 : echo keep.source term verbatim (fitLinearModels.Snw:284)
21 : echo keep.source term verbatim pdf  (fitLinearModels.Snw:319)
22 : echo keep.source term verbatim pdf  (fitLinearModels.Snw:324)
23 : echo keep.source term verbatim pdf  (fitLinearModels.Snw:331)

You can now run (pdf)latex on ‘fitLinearModels.tex’
\end{Soutput}
\begin{Sinput}
> #covariates.dat<- subset(covariates.dat,covariates.dat$Distance<4)
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> if(!("Distance" %in% names(full.covariates.dat))) {
+    setwd('data/wwheat/')
+    Sweave("fitFullLinearModels.Snw")
+    setwd(current.wd)
+ }
\end{Sinput}
\begin{Soutput}
Writing to file fitFullLinearModels.tex
Processing code chunks with options ...
 1 : keep.source term verbatim (fitFullLinearModels.Snw:7)
 2 : echo keep.source term verbatim (fitFullLinearModels.Snw:17)
 3 : echo keep.source term verbatim (fitFullLinearModels.Snw:50)
 4 : echo keep.source term verbatim (fitFullLinearModels.Snw:63)
 5 : echo keep.source term verbatim (fitFullLinearModels.Snw:96)
 6 : echo keep.source term verbatim (fitFullLinearModels.Snw:104)
 7 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:130)
 8 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:137)
 9 : echo keep.source term verbatim (fitFullLinearModels.Snw:146)
10 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:155)
11 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:161)
12 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:167)
13 : echo keep.source term verbatim (fitFullLinearModels.Snw:173)
14 : echo keep.source term verbatim (fitFullLinearModels.Snw:181)
15 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:194)
16 : echo keep.source term verbatim (fitFullLinearModels.Snw:199)
17 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:211)
18 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:216)
19 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:220)
20 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:224)
21 : echo keep.source term verbatim pdf  (label = rpn, fitFullLinearModels.Snw:237)
22 : echo keep.source term verbatim (fitFullLinearModels.Snw:242)
23 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:285)
24 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:295)
25 : echo keep.source term verbatim (fitFullLinearModels.Snw:320)
26 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:357)
27 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:362)
28 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:369)
29 : echo keep.source term verbatim pdf  (fitFullLinearModels.Snw:373)

You can now run (pdf)latex on ‘fitFullLinearModels.tex’
\end{Soutput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$Distance,full.covariates.dat$statecounty,main="Distance to HWW RPN Site",legend="degrees",palette=coef.palette)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-distance}

\begin{Schunk}
\begin{Sinput}
> full.covariates.dat<- subset(full.covariates.dat,full.covariates.dat$Distance<4)
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$Distance,full.covariates.dat$statecounty,main="Distance to HWW RPN Site",legend="degrees",palette=coef.palette )
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-distance}

\begin{Schunk}
\begin{Sinput}
> dist.plot <- ggmap.full.values(full.covariates.dat$DistanceGPS,full.covariates.dat$statecounty,main="Distance to HWW RPN Site",legend="degrees",palette=coef.palette ,include.wa=TRUE)  + theme_bw()
> dist.plot
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-distance}

\begin{Schunk}
\begin{Sinput}
> par(bg="white")
> grid.arrange(arrangeGrob(
+   county.yield.plot,
+   dist.plot,
+    as.table=TRUE,
+    widths=c(8, 10),
+    ncol=2))
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-intro}

Limit our analysis to the plains states
\begin{Schunk}
\begin{Sinput}
> full.covariates.dat<- subset(full.covariates.dat,!(full.covariates.dat$state %in% c("washington","idaho")))
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> i.dat <- subset(full.covariates.dat,full.covariates.dat$I<6)
> ggmap.full.values(i.dat$I,i.dat$statecounty,main="N. Autocorrelation of Yield Changes",legend="Moran's I",palette=coef.palette ) + theme_bw()
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-moran}

\begin{Schunk}
\begin{Sinput}
> covariates.base <- covariates.dat
> full.covariates.base <- full.covariates.dat
\end{Sinput}
\end{Schunk}


\begin{Schunk}
\begin{Sinput}
> form1 <- paste(names(covariates.dat)[yield.idx]," ~ ",covariate.terms[1])
> form2 <- paste(names(covariates.dat)[yield.idx+1]," ~ ",covariate.terms[2])
> form3 <- paste(names(covariates.dat)[yield.idx]," ~ ",covariate.terms[1])
> form4 <- paste(names(covariates.dat)[yield.idx+1]," ~ ",covariate.terms[1])
> for(idx in 2:length(covariate.terms) ) {
+    if((idx%% 2)==0) {
+       if(idx>2) {
+          form2<-paste(form2,"+",covariate.terms[idx])
+       }
+    } else {
+       form1<-paste(form1,"+",covariate.terms[idx])
+    }
+    form3<-paste(form3,"+",covariate.terms[idx])
+    form4<-paste(form4,"+",covariate.terms[idx])
+ }
> form1<-paste(form1,"+ Distance")
> form2<-paste(form2,"+ Distance")
> form3<-paste(form3,"+ Distance")
> form4<-paste(form4,"+ Distance")
> cov1.lm <- lm(form1,data=na.omit(covariates.dat))
> cov2.lm <- lm(form2,data=na.omit(covariates.dat))
> cov3.lm <- lm(form3,data=na.omit(covariates.dat))
> cov4.lm <- lm(form4,data=na.omit(covariates.dat))
> full.cov1.lm <- lm(form1,data=na.omit(full.covariates.dat))
> full.cov2.lm <- lm(form2,data=na.omit(full.covariates.dat))
> full.cov3.lm <- lm(form3,data=na.omit(full.covariates.dat))
> full.cov4.lm <- lm(form4,data=na.omit(full.covariates.dat))
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> full.best1 <- step(full.cov1.lm,direction = "both")
> full.best2 <- step(full.cov2.lm,direction = "both")
> full.best3 <- step(full.cov3.lm,direction = "both")
> full.best4 <- step(full.cov4.lm,direction = "both")
\end{Sinput}
\end{Schunk}

\section{Yield Average Covariates}
\begin{Schunk}
\begin{Sinput}
> summary(full.cov1.lm)
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = form1, data = na.omit(full.covariates.dat))

Residuals:
     Min       1Q   Median       3Q      Max 
-14.5650  -2.6594  -0.0047   2.4314  28.3929 

Coefficients:
                                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)                      -4.359e+01  3.099e+01  -1.406 0.160441    
Farm_TonsN.a                     -1.167e-04  2.044e-04  -0.571 0.568350    
Farm_TonsP.a                     -2.911e-04  3.162e-04  -0.921 0.357850    
Farm_TonsK.a                     -4.463e-04  3.056e-04  -1.460 0.145076    
Tons_N_Exc.a                     -4.291e-04  5.975e-04  -0.718 0.473079    
Tons_P2O5_Exc.a                   2.630e-04  3.389e-04   0.776 0.438243    
Tons_K2O_Exc.a                    6.768e-04  7.201e-04   0.940 0.347901    
Tons_N_Recovered.a                4.578e-04  6.616e-04   0.692 0.489447    
Tons_P2O5_Recovered.a             3.388e-04  4.741e-04   0.715 0.475345    
Tons_K2O_Recovered.a              2.848e-04  5.293e-04   0.538 0.590919    
Tons_N_Fixed_Legumes.a            3.147e-04  2.488e-04   1.265 0.206710    
Tons_N_Rem.a                      5.065e-04  1.999e-04   2.533 0.011725 *  
Tons_P2O5_Rem.a                  -3.028e-04  3.047e-04  -0.994 0.320932    
Tons_K2O_Rem.a                    3.281e-04  2.823e-04   1.162 0.245924    
BalanceN_Tons.a                  -1.700e-04  3.517e-04  -0.483 0.629151    
BalanceP2O5_Tons.a                2.959e-04  5.426e-04   0.545 0.585917    
BalanceK2O_Tons.a                -1.017e-05  3.536e-04  -0.029 0.977056    
RatioN.a                          4.919e+00  2.470e+00   1.991 0.047186 *  
RatioP2O5.a                      -9.948e-01  3.867e-01  -2.572 0.010499 *  
RatioK2O.a                        6.240e-02  1.502e-01   0.416 0.678018    
N_PPCA.a                          1.854e-03  1.380e-03   1.343 0.180069    
P2O5_PPCA.a                       6.306e-04  1.592e-03   0.396 0.692311    
K2O_PPCA.a                        4.036e-04  1.266e-03   0.319 0.750051    
FarmNPPCA.a                       2.686e-03  1.119e-03   2.400 0.016913 *  
FarmPPPCA.a                       1.935e-04  1.698e-03   0.114 0.909334    
FarmKPPCA.a                       2.670e-03  1.200e-03   2.225 0.026673 *  
X21Crop_TotalPlantedAc.a         -1.089e-04  7.153e-05  -1.523 0.128726    
X21Crop_TotalHarvestAc.a          1.464e-04  8.587e-05   1.705 0.089070 .  
Total_Harvested_Cropland_Acres.a -1.813e-05  4.734e-05  -0.383 0.701903    
TotalCropland.a                  -8.262e-06  6.390e-06  -1.293 0.196860    
min.a                            -2.056e+00  8.697e-01  -2.364 0.018624 *  
max.a                            -5.179e-01  9.884e-01  -0.524 0.600619    
heat.a                           -2.013e-01  8.657e-01  -0.233 0.816277    
precip.a                          4.807e+00  1.397e+00   3.441 0.000647 ***
sun.a                             3.448e-03  1.062e-03   3.247 0.001277 ** 
day.a                             5.421e-01  1.895e-01   2.861 0.004477 ** 
night.a                           2.963e-01  4.653e-01   0.637 0.524593    
fine.a                            1.744e+00  3.108e-01   5.611 4.02e-08 ***
harvested.a                      -6.819e-06  9.816e-05  -0.069 0.944661    
acres.a                           1.192e-05  9.512e-05   0.125 0.900323    
mean.income                       3.798e-05  1.055e-05   3.600 0.000363 ***
Distance                         -5.136e-01  4.912e-01  -1.046 0.296444    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.621 on 359 degrees of freedom
Multiple R-squared:  0.5434,	Adjusted R-squared:  0.4912 
F-statistic: 10.42 on 41 and 359 DF,  p-value: < 2.2e-16
\end{Soutput}
\begin{Sinput}
> #summary(aov(full.cov1.lm))
> summary(full.best1)
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = yield.a ~ Farm_TonsK.a + Tons_K2O_Exc.a + Tons_N_Rem.a + 
    RatioN.a + RatioP2O5.a + N_PPCA.a + FarmNPPCA.a + FarmKPPCA.a + 
    X21Crop_TotalPlantedAc.a + X21Crop_TotalHarvestAc.a + TotalCropland.a + 
    min.a + precip.a + sun.a + day.a + fine.a + mean.income + 
    Tons_N_Fixed_Legumes.a, data = na.omit(full.covariates.dat))

Residuals:
     Min       1Q   Median       3Q      Max 
-14.9844  -2.5290   0.0534   2.2838  28.7094 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)              -5.261e+01  1.143e+01  -4.603 5.68e-06 ***
Farm_TonsK.a             -4.227e-04  2.781e-04  -1.520  0.12936    
Tons_K2O_Exc.a            3.964e-04  2.179e-04   1.819  0.06962 .  
Tons_N_Rem.a              6.616e-04  1.397e-04   4.735 3.10e-06 ***
RatioN.a                  3.926e+00  2.159e+00   1.818  0.06978 .  
RatioP2O5.a              -1.075e+00  3.420e-01  -3.143  0.00180 ** 
N_PPCA.a                  1.628e-03  1.133e-03   1.437  0.15158    
FarmNPPCA.a               2.566e-03  9.818e-04   2.613  0.00933 ** 
FarmKPPCA.a               2.798e-03  1.089e-03   2.569  0.01056 *  
X21Crop_TotalPlantedAc.a -8.766e-05  3.507e-05  -2.500  0.01285 *  
X21Crop_TotalHarvestAc.a  1.098e-04  3.590e-05   3.059  0.00238 ** 
TotalCropland.a          -9.276e-06  4.870e-06  -1.904  0.05760 .  
min.a                    -2.431e+00  3.700e-01  -6.570 1.65e-10 ***
precip.a                  4.545e+00  9.705e-01   4.683 3.93e-06 ***
sun.a                     3.485e-03  6.298e-04   5.533 5.84e-08 ***
day.a                     4.688e-01  1.554e-01   3.017  0.00272 ** 
fine.a                    1.835e+00  2.904e-01   6.319 7.36e-10 ***
mean.income               3.503e-05  8.856e-06   3.955 9.12e-05 ***
Tons_N_Fixed_Legumes.a    3.105e-04  2.217e-04   1.400  0.16226    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.551 on 382 degrees of freedom
Multiple R-squared:  0.5287,	Adjusted R-squared:  0.5065 
F-statistic: 23.81 on 18 and 382 DF,  p-value: < 2.2e-16
\end{Soutput}
\begin{Sinput}
> full.best1 <- update(full.best1,data=full.covariates.dat)
> summary(full.best2)
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = yield.b ~ Farm_TonsP.b + Tons_N_Rem.b + RatioP2O5.b + 
    X21Crop_TotalPlantedAc.b + X21Crop_TotalHarvestAc.b + TotalCropland.b + 
    max.b + heat.b + precip.b + sun.b + day.b + wheat_frac, data = na.omit(full.covariates.dat))

Residuals:
    Min      1Q  Median      3Q     Max 
-3.9479 -0.3151  0.0808  0.4417  1.6807 

Coefficients:
                          Estimate Std. Error t value Pr(>|t|)    
(Intercept)               0.977709   0.147409   6.633 1.11e-10 ***
Farm_TonsP.b             -0.010970   0.006727  -1.631 0.103738    
Tons_N_Rem.b             -0.011908   0.007445  -1.600 0.110520    
RatioP2O5.b              -0.038455   0.016777  -2.292 0.022433 *  
X21Crop_TotalPlantedAc.b -0.479542   0.236198  -2.030 0.043012 *  
X21Crop_TotalHarvestAc.b  0.750081   0.222503   3.371 0.000824 ***
TotalCropland.b          -0.110729   0.056069  -1.975 0.048992 *  
max.b                    -1.184415   0.306487  -3.864 0.000130 ***
heat.b                    6.193343   1.417880   4.368 1.61e-05 ***
precip.b                 -0.184358   0.118905  -1.550 0.121847    
sun.b                    -2.727491   0.963212  -2.832 0.004872 ** 
day.b                     0.115743   0.045934   2.520 0.012144 *  
wheat_frac               -0.007890   0.002156  -3.660 0.000287 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.7465 on 388 degrees of freedom
Multiple R-squared:  0.3383,	Adjusted R-squared:  0.3178 
F-statistic: 16.53 on 12 and 388 DF,  p-value: < 2.2e-16
\end{Soutput}
\begin{Sinput}
> #summary(aov(full.best1))
> #summary(full.cov3.lm)
> #summary(aov(full.cov3.lm))
> summary(full.best3)
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = yield.a ~ Farm_TonsK.a + Farm_TonsK.b + Tons_N_Exc.b + 
    Tons_P2O5_Exc.a + Tons_P2O5_Exc.b + Tons_N_Recovered.a + 
    Tons_P2O5_Recovered.a + Tons_N_Fixed_Legumes.a + Tons_N_Rem.a + 
    Tons_P2O5_Rem.a + Tons_P2O5_Rem.b + RatioN.b + RatioP2O5.a + 
    RatioP2O5.b + RatioK2O.a + RatioK2O.b + FarmNPPCA.a + FarmNPPCA.b + 
    FarmPPPCA.b + FarmKPPCA.a + X21Crop_TotalPlantedAc.a + X21Crop_TotalHarvestAc.a + 
    Total_Harvested_Cropland_Acres.a + min.a + max.b + heat.b + 
    precip.a + precip.b + sun.a + sun.b + day.b + night.b + fine.a + 
    harvested.b + acres.a + mean.income + wheat_frac, data = na.omit(full.covariates.dat))

Residuals:
     Min       1Q   Median       3Q      Max 
-11.6816  -2.2227  -0.0016   2.1238  26.6373 

Coefficients:
                                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)                      -4.324e+01  1.228e+01  -3.521 0.000485 ***
Farm_TonsK.a                     -3.879e-04  2.704e-04  -1.435 0.152270    
Farm_TonsK.b                      9.082e-02  4.841e-02   1.876 0.061423 .  
Tons_N_Exc.b                      8.791e-02  5.051e-02   1.741 0.082610 .  
Tons_P2O5_Exc.a                   4.821e-04  2.103e-04   2.293 0.022447 *  
Tons_P2O5_Exc.b                  -7.071e-02  3.966e-02  -1.783 0.075446 .  
Tons_N_Recovered.a                8.813e-04  5.372e-04   1.641 0.101763    
Tons_P2O5_Recovered.a             6.873e-04  4.192e-04   1.639 0.102001    
Tons_N_Fixed_Legumes.a            3.501e-04  2.147e-04   1.631 0.103850    
Tons_N_Rem.a                      2.760e-04  1.713e-04   1.611 0.107968    
Tons_P2O5_Rem.a                  -6.655e-04  2.709e-04  -2.456 0.014500 *  
Tons_P2O5_Rem.b                   1.186e-01  5.997e-02   1.977 0.048758 *  
RatioN.b                          4.829e-01  2.102e-01   2.297 0.022175 *  
RatioP2O5.a                      -1.675e+00  3.118e-01  -5.371 1.40e-07 ***
RatioP2O5.b                      -6.235e-01  1.601e-01  -3.895 0.000117 ***
RatioK2O.a                        4.186e-01  1.658e-01   2.525 0.011993 *  
RatioK2O.b                        6.122e-01  1.261e-01   4.853 1.81e-06 ***
FarmNPPCA.a                       2.200e-03  9.368e-04   2.349 0.019376 *  
FarmNPPCA.b                       9.929e-02  7.179e-02   1.383 0.167471    
FarmPPPCA.b                       6.349e-02  4.194e-02   1.514 0.130883    
FarmKPPCA.a                       2.929e-03  1.071e-03   2.736 0.006521 ** 
X21Crop_TotalPlantedAc.a         -7.511e-05  3.793e-05  -1.980 0.048422 *  
X21Crop_TotalHarvestAc.a          1.789e-04  5.228e-05   3.421 0.000695 ***
Total_Harvested_Cropland_Acres.a -9.295e-05  3.747e-05  -2.481 0.013570 *  
min.a                            -2.000e+00  2.888e-01  -6.927 1.96e-11 ***
max.b                             1.210e+01  3.098e+00   3.906 0.000112 ***
heat.b                            3.259e+01  9.091e+00   3.585 0.000383 ***
precip.a                          1.912e+00  9.495e-01   2.013 0.044801 *  
precip.b                          1.079e+00  7.089e-01   1.522 0.128990    
sun.a                             3.873e-03  6.907e-04   5.607 4.08e-08 ***
sun.b                            -1.174e+01  7.926e+00  -1.481 0.139498    
day.b                             5.754e-01  3.605e-01   1.596 0.111309    
night.b                           9.563e-03  5.912e-03   1.617 0.106649    
fine.a                            1.880e+00  2.807e-01   6.697 8.10e-11 ***
harvested.b                       7.720e-02  4.931e-02   1.566 0.118285    
acres.a                           1.796e-05  1.103e-05   1.629 0.104221    
mean.income                       3.590e-05  8.432e-06   4.258 2.63e-05 ***
wheat_frac                       -8.181e-02  2.749e-02  -2.976 0.003121 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.027 on 363 degrees of freedom
Multiple R-squared:  0.6492,	Adjusted R-squared:  0.6135 
F-statistic: 18.16 on 37 and 363 DF,  p-value: < 2.2e-16
\end{Soutput}
\begin{Sinput}
> #summary(aov(full.best3))
\end{Sinput}
\end{Schunk}

\section{Yield Change Covariates}
\begin{Schunk}
\begin{Sinput}
> summary(full.cov2.lm)
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = form2, data = na.omit(full.covariates.dat))

Residuals:
    Min      1Q  Median      3Q     Max 
-3.7725 -0.3263  0.0392  0.4182  1.6796 

Coefficients:
                                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)                       1.190e+00  2.124e-01   5.604 4.18e-08 ***
Farm_TonsN.b                      1.104e-02  8.882e-03   1.243 0.214661    
Farm_TonsP.b                     -1.230e-02  7.231e-03  -1.701 0.089733 .  
Farm_TonsK.b                     -4.184e-03  8.852e-03  -0.473 0.636778    
Tons_N_Exc.b                      1.842e-02  1.151e-02   1.600 0.110420    
Tons_P2O5_Exc.b                  -7.084e-03  7.539e-03  -0.940 0.348015    
Tons_K2O_Exc.b                   -9.987e-03  9.835e-03  -1.015 0.310590    
Tons_N_Recovered.b                1.490e-03  1.200e-02   0.124 0.901242    
Tons_P2O5_Recovered.b             2.567e-03  1.172e-02   0.219 0.826685    
Tons_K2O_Recovered.b              5.232e-03  8.192e-03   0.639 0.523450    
Tons_N_Fixed_Legumes.b            9.199e-03  8.037e-03   1.145 0.253136    
Tons_N_Rem.b                     -9.217e-03  8.012e-03  -1.150 0.250721    
Tons_P2O5_Rem.b                   5.686e-03  1.145e-02   0.497 0.619841    
Tons_K2O_Rem.b                   -2.348e-03  1.228e-02  -0.191 0.848438    
BalanceN_Tons.b                  -8.948e-05  1.254e-02  -0.007 0.994309    
BalanceP2O5_Tons.b                8.231e-03  1.297e-02   0.635 0.525982    
BalanceK2O_Tons.b                 9.904e-03  9.035e-03   1.096 0.273695    
RatioN.b                          4.318e-02  3.819e-02   1.131 0.258942    
RatioP2O5.b                      -5.095e-02  2.670e-02  -1.909 0.057108 .  
RatioK2O.b                       -1.577e-03  2.403e-02  -0.066 0.947712    
N_PPCA.b                          6.885e-03  1.261e-02   0.546 0.585418    
P2O5_PPCA.b                      -5.283e-03  9.742e-03  -0.542 0.587968    
K2O_PPCA.b                        4.518e-03  7.708e-03   0.586 0.558168    
FarmNPPCA.b                      -5.153e-03  1.212e-02  -0.425 0.670872    
FarmPPPCA.b                       3.693e-03  7.666e-03   0.482 0.630236    
FarmKPPCA.b                       2.463e-03  7.821e-03   0.315 0.753048    
X21Crop_TotalPlantedAc.b         -5.332e-01  2.538e-01  -2.101 0.036365 *  
X21Crop_TotalHarvestAc.b          7.185e-01  2.796e-01   2.570 0.010582 *  
Total_Harvested_Cropland_Acres.b  5.642e-02  1.316e-01   0.429 0.668328    
TotalCropland.b                  -1.141e-01  6.584e-02  -1.733 0.083966 .  
min.b                             1.407e-02  2.206e-02   0.638 0.523994    
max.b                            -1.052e+00  3.900e-01  -2.698 0.007310 ** 
heat.b                            5.638e+00  1.601e+00   3.522 0.000484 ***
precip.b                         -2.705e-01  1.341e-01  -2.016 0.044503 *  
sun.b                            -3.408e+00  1.237e+00  -2.755 0.006167 ** 
day.b                             1.124e-01  5.556e-02   2.024 0.043748 *  
night.b                           3.205e-04  1.117e-03   0.287 0.774428    
fine.b                           -3.664e-02  2.381e-02  -1.539 0.124699    
harvested.b                       2.750e-03  9.222e-03   0.298 0.765739    
acres.b                           9.756e-04  2.377e-03   0.410 0.681741    
wheat_frac                       -6.485e-03  2.652e-03  -2.445 0.014964 *  
Distance                         -9.299e-02  7.432e-02  -1.251 0.211672    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.7585 on 359 degrees of freedom
Multiple R-squared:  0.368,	Adjusted R-squared:  0.2959 
F-statistic: 5.099 on 41 and 359 DF,  p-value: < 2.2e-16
\end{Soutput}
\begin{Sinput}
> #summary(aov(full.cov2.lm))
> summary(full.best2)
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = yield.b ~ Farm_TonsP.b + Tons_N_Rem.b + RatioP2O5.b + 
    X21Crop_TotalPlantedAc.b + X21Crop_TotalHarvestAc.b + TotalCropland.b + 
    max.b + heat.b + precip.b + sun.b + day.b + wheat_frac, data = na.omit(full.covariates.dat))

Residuals:
    Min      1Q  Median      3Q     Max 
-3.9479 -0.3151  0.0808  0.4417  1.6807 

Coefficients:
                          Estimate Std. Error t value Pr(>|t|)    
(Intercept)               0.977709   0.147409   6.633 1.11e-10 ***
Farm_TonsP.b             -0.010970   0.006727  -1.631 0.103738    
Tons_N_Rem.b             -0.011908   0.007445  -1.600 0.110520    
RatioP2O5.b              -0.038455   0.016777  -2.292 0.022433 *  
X21Crop_TotalPlantedAc.b -0.479542   0.236198  -2.030 0.043012 *  
X21Crop_TotalHarvestAc.b  0.750081   0.222503   3.371 0.000824 ***
TotalCropland.b          -0.110729   0.056069  -1.975 0.048992 *  
max.b                    -1.184415   0.306487  -3.864 0.000130 ***
heat.b                    6.193343   1.417880   4.368 1.61e-05 ***
precip.b                 -0.184358   0.118905  -1.550 0.121847    
sun.b                    -2.727491   0.963212  -2.832 0.004872 ** 
day.b                     0.115743   0.045934   2.520 0.012144 *  
wheat_frac               -0.007890   0.002156  -3.660 0.000287 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.7465 on 388 degrees of freedom
Multiple R-squared:  0.3383,	Adjusted R-squared:  0.3178 
F-statistic: 16.53 on 12 and 388 DF,  p-value: < 2.2e-16
\end{Soutput}
\begin{Sinput}
> full.best2 <- update(full.best2,data=full.covariates.dat)
> summary(full.best2)
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = yield.b ~ Farm_TonsP.b + Tons_N_Rem.b + RatioP2O5.b + 
    X21Crop_TotalPlantedAc.b + X21Crop_TotalHarvestAc.b + TotalCropland.b + 
    max.b + heat.b + precip.b + sun.b + day.b + wheat_frac, data = full.covariates.dat)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.6559 -0.4096  0.0529  0.5187  3.2520 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)               0.7811940  0.1230385   6.349 3.64e-10 ***
Farm_TonsP.b             -0.0005352  0.0063683  -0.084 0.933044    
Tons_N_Rem.b             -0.0102714  0.0063156  -1.626 0.104271    
RatioP2O5.b              -0.0735908  0.0142572  -5.162 3.10e-07 ***
X21Crop_TotalPlantedAc.b -0.1902742  0.0771396  -2.467 0.013850 *  
X21Crop_TotalHarvestAc.b  0.3576666  0.0722203   4.952 8.96e-07 ***
TotalCropland.b          -0.1773562  0.0401759  -4.414 1.15e-05 ***
max.b                    -1.2655993  0.3018489  -4.193 3.07e-05 ***
heat.b                    2.8564762  1.2350864   2.313 0.020990 *  
precip.b                  0.2654134  0.0767802   3.457 0.000576 ***
sun.b                     0.7829198  0.7031124   1.114 0.265828    
day.b                    -0.0829482  0.0352901  -2.350 0.018994 *  
wheat_frac               -0.0123615  0.0017806  -6.942 8.02e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9406 on 794 degrees of freedom
  (9 observations deleted due to missingness)
Multiple R-squared:  0.3291,	Adjusted R-squared:  0.319 
F-statistic: 32.46 on 12 and 794 DF,  p-value: < 2.2e-16
\end{Soutput}
\begin{Sinput}
> #summary(aov(full.best2))
> #summary(full.cov4.lm)
> #summary(aov(full.cov4.lm))
> summary(full.best4)
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = yield.b ~ Farm_TonsP.b + Tons_N_Recovered.a + Tons_N_Fixed_Legumes.a + 
    Tons_N_Rem.a + Tons_P2O5_Rem.a + Tons_K2O_Rem.a + BalanceP2O5_Tons.b + 
    BalanceK2O_Tons.a + RatioP2O5.a + RatioK2O.a + N_PPCA.a + 
    K2O_PPCA.a + K2O_PPCA.b + FarmKPPCA.a + FarmKPPCA.b + X21Crop_TotalHarvestAc.a + 
    X21Crop_TotalHarvestAc.b + Total_Harvested_Cropland_Acres.a + 
    TotalCropland.a + min.b + heat.b + sun.a + day.b + night.a + 
    night.b + fine.a + fine.b + harvested.a + acres.a + wheat_frac, 
    data = na.omit(full.covariates.dat))

Residuals:
    Min      1Q  Median      3Q     Max 
-3.2721 -0.2935  0.0147  0.3651  1.7098 

Coefficients:
                                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)                       1.009e+01  1.674e+00   6.027 4.05e-09 ***
Farm_TonsP.b                     -9.715e-03  6.531e-03  -1.488 0.137730    
Tons_N_Recovered.a                1.744e-04  8.808e-05   1.980 0.048416 *  
Tons_N_Fixed_Legumes.a            8.674e-05  3.579e-05   2.423 0.015855 *  
Tons_N_Rem.a                      5.889e-05  2.765e-05   2.130 0.033865 *  
Tons_P2O5_Rem.a                  -9.178e-05  4.421e-05  -2.076 0.038578 *  
Tons_K2O_Rem.a                   -1.206e-04  3.990e-05  -3.022 0.002688 ** 
BalanceP2O5_Tons.b                1.475e-02  9.196e-03   1.604 0.109479    
BalanceK2O_Tons.a                 1.097e-04  4.902e-05   2.237 0.025866 *  
RatioP2O5.a                       2.067e-01  5.111e-02   4.043 6.42e-05 ***
RatioK2O.a                        1.037e-01  2.038e-02   5.089 5.75e-07 ***
N_PPCA.a                          3.201e-04  1.287e-04   2.487 0.013329 *  
K2O_PPCA.a                       -5.445e-04  1.771e-04  -3.075 0.002261 ** 
K2O_PPCA.b                        1.083e-02  6.723e-03   1.612 0.107888    
FarmKPPCA.a                       5.495e-04  1.670e-04   3.291 0.001095 ** 
FarmKPPCA.b                      -1.158e-02  6.953e-03  -1.665 0.096684 .  
X21Crop_TotalHarvestAc.a          1.113e-05  6.801e-06   1.637 0.102490    
X21Crop_TotalHarvestAc.b          2.432e-01  4.956e-02   4.907 1.39e-06 ***
Total_Harvested_Cropland_Acres.a -1.235e-05  7.067e-06  -1.747 0.081391 .  
TotalCropland.a                   2.312e-06  8.319e-07   2.780 0.005720 ** 
min.b                             2.613e-02  1.873e-02   1.395 0.163742    
heat.b                            5.665e+00  1.490e+00   3.803 0.000167 ***
sun.a                            -6.280e-04  1.019e-04  -6.166 1.83e-09 ***
day.b                             3.866e-01  5.509e-02   7.017 1.09e-11 ***
night.a                           1.692e-01  3.910e-02   4.329 1.93e-05 ***
night.b                           1.471e-03  9.935e-04   1.480 0.139646    
fine.a                           -1.492e-01  4.478e-02  -3.332 0.000950 ***
fine.b                            6.301e-02  3.120e-02   2.019 0.044164 *  
harvested.a                       1.532e-05  8.647e-06   1.772 0.077275 .  
acres.a                          -1.400e-05  8.136e-06  -1.721 0.086139 .  
wheat_frac                       -9.049e-03  4.378e-03  -2.067 0.039451 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.6777 on 370 degrees of freedom
Multiple R-squared:   0.48,	Adjusted R-squared:  0.4378 
F-statistic: 11.38 on 30 and 370 DF,  p-value: < 2.2e-16
\end{Soutput}
\begin{Sinput}
> full.best4 <- update(full.best4,data=full.covariates.dat)
> #summary(update(full.best4,data=full.covariates.dat))
> #summary(aov(full.best4))
\end{Sinput}
\end{Schunk}

We'll color by state, so convert index



\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$max.b,full.covariates.dat$statecounty,main="A. Daily Max Air Temperature ",legend="%/yr",palette=yield.palette) + theme_bw()
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-maxb}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$heat.b,full.covariates.dat$statecounty,main="B. Daily Max Heat Index",legend="%/yr",palette=yield.palette) + theme_bw()
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-heatb}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$precip.b,full.covariates.dat$statecounty,main="C. Daily Precipitation",legend="%/yr",palette=yield.palette) + theme_bw()
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-precipb}

\begin{Schunk}
\begin{Sinput}
> precipb.yield.plot <- ggplot(full.covariates.dat, aes(precip.b,yield.b)) + theme_bw() + 
+                       scale_fill_manual(values=fullPalette) + scale_colour_manual(values=fullPalette) + 
+                       geom_point(aes(color=state),size=2,alpha = 0.2) + 
+                       geom_smooth(aes(group=state,color=state),weight=16,se = FALSE,method="lm")
> precipb.yield.plot
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-precipbregress}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$sun.b,full.covariates.dat$statecounty,main="D. Daily Sunlight",legend="%/yr",palette=yield.palette)  + theme_bw()
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-sunb}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$fine.b,full.covariates.dat$statecounty,main="Fine b",legend="%/yr",palette=yield.palette)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-fineb}


\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$day.b,full.covariates.dat$statecounty,main="E. Day Land Surface Temperature",legend="%/yr",palette=yield.palette)  + theme_bw()
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-dayb}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$Farm_TonsN.b,full.covariates.dat$statecounty,main="Interpolated Adjusted AAPFCO Farm Inputs, Ton N",legend="%/yr",palette=yield.palette)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-Farm_TonsN}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$Tons_P2O5_Exc.b,full.covariates.dat$statecounty,main="Tons_P2O5_Exc b",legend="%/yr",palette=yield.palette)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-TonsP2O5Exc}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$Tons_N_Rem.b,full.covariates.dat$statecounty,main="Tons_N_Rem b",legend="%/yr",palette=yield.palette)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-TonsNRem}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$Tons_P2O5_Rem.b,full.covariates.dat$statecounty,main="Tons_P2O5_Rem b",legend="%/yr",palette=yield.palette)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-TonsP2O5Rem}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$RatioP2O5.b,full.covariates.dat$statecounty,main="H. Net Removal to Use Ratio, P",legend="%/yr",palette=yield.palette)  + theme_bw()
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-RatioP2O5}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$FarmNPPCA.b,full.covariates.dat$statecounty,main="FarmNPPCA b",legend="%/yr",palette=yield.palette)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-FarmNPPCA}
FarmNPPCA.b

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$X21Crop_TotalPlantedAc.b,full.covariates.dat$statecounty,main="X21Crop_TotalPlantedAc b",legend="%/yr",palette=yield.palette)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-X21CropTotalPlantedAc}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$X21Crop_TotalHarvestAc.b,full.covariates.dat$statecounty,main="J. Sum of 21 Crop Acres Harves",legend="%/yr",palette=yield.palette) + theme_bw()
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-X21CropTotalHarvestAc}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$TotalCropland.b,full.covariates.dat$statecounty,main="TotalCropland b",legend="%/yr",palette=yield.palette)
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-TotalCropland}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$wheat_frac,full.covariates.dat$statecounty,main="L. Percent Harvested Acres, Wheat",legend="%",palette=yield.palette) + theme_bw()
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-wheatfrac}


\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$yield.a,full.covariates.dat$statecounty,main="Average Yield, 1984-2014",legend="bu/ac",palette=yield.palette) + theme_bw()
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-yielda}


\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.covariates.dat$yield.b,full.covariates.dat$statecounty,main="Yield Change, 1984-2014",legend="%/yr",palette=yield.palette) + theme_bw()
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-yieldb}

\begin{Schunk}
\begin{Sinput}
> ggmap.full.values(full.best2$residuals,names(full.best2$residuals),main="Best 2 Residuals",palette=yield.palette) + theme_bw()
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-yieldres}

\section{PCA}

One data point in texas skews PCA. It covaries with IJ (total cropland)
so
\begin{Schunk}
\begin{Sinput}
> plot(hist(full.covariates.dat$X21Crop_TotalPlantedAc.b))
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> full.covariates.dat <- subset(full.covariates.dat,full.covariates.dat$X21Crop_TotalPlantedAc.b<10)
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> full.best1 <- update(full.best1,data=full.covariates.dat)
> summary(full.best1)
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = yield.a ~ Farm_TonsK.a + Tons_K2O_Exc.a + Tons_N_Rem.a + 
    RatioN.a + RatioP2O5.a + N_PPCA.a + FarmNPPCA.a + FarmKPPCA.a + 
    X21Crop_TotalPlantedAc.a + X21Crop_TotalHarvestAc.a + TotalCropland.a + 
    min.a + precip.a + sun.a + day.a + fine.a + mean.income + 
    Tons_N_Fixed_Legumes.a, data = full.covariates.dat)

Residuals:
    Min      1Q  Median      3Q     Max 
-23.543  -3.149  -0.066   2.915  63.732 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)              -4.172e+01  8.965e+00  -4.653 3.83e-06 ***
Farm_TonsK.a             -3.157e-04  2.711e-04  -1.165 0.244547    
Tons_K2O_Exc.a            1.758e-04  2.080e-04   0.845 0.398363    
Tons_N_Rem.a              8.347e-04  1.351e-04   6.179 1.03e-09 ***
RatioN.a                 -8.084e-02  2.501e-01  -0.323 0.746613    
RatioP2O5.a              -1.092e+00  3.783e-01  -2.887 0.003992 ** 
N_PPCA.a                  7.255e-04  7.949e-04   0.913 0.361721    
FarmNPPCA.a               3.522e-03  9.795e-04   3.596 0.000343 ***
FarmKPPCA.a               6.478e-03  1.034e-03   6.262 6.26e-10 ***
X21Crop_TotalPlantedAc.a -9.718e-05  1.667e-05  -5.829 8.14e-09 ***
X21Crop_TotalHarvestAc.a  1.126e-04  1.730e-05   6.510 1.34e-10 ***
TotalCropland.a          -7.361e-06  4.426e-06  -1.663 0.096674 .  
min.a                    -2.657e+00  2.207e-01 -12.042  < 2e-16 ***
precip.a                  4.128e+00  6.730e-01   6.133 1.37e-09 ***
sun.a                     3.167e-03  5.172e-04   6.123 1.45e-09 ***
day.a                     6.003e-01  1.085e-01   5.535 4.25e-08 ***
fine.a                    1.372e+00  2.592e-01   5.291 1.58e-07 ***
mean.income               3.340e-05  8.384e-06   3.984 7.42e-05 ***
Tons_N_Fixed_Legumes.a    2.786e-04  2.346e-04   1.188 0.235378    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.536 on 787 degrees of freedom
  (3 observations deleted due to missingness)
Multiple R-squared:  0.5147,	Adjusted R-squared:  0.5036 
F-statistic: 46.37 on 18 and 787 DF,  p-value: < 2.2e-16
\end{Soutput}
\begin{Sinput}
> full.best2 <- update(full.best2,data=full.covariates.dat)
> summary(full.best2)
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = yield.b ~ Farm_TonsP.b + Tons_N_Rem.b + RatioP2O5.b + 
    X21Crop_TotalPlantedAc.b + X21Crop_TotalHarvestAc.b + TotalCropland.b + 
    max.b + heat.b + precip.b + sun.b + day.b + wheat_frac, data = full.covariates.dat)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.6045 -0.3953  0.0533  0.5234  3.2221 

Coefficients:
                          Estimate Std. Error t value Pr(>|t|)    
(Intercept)               0.788744   0.122888   6.418 2.37e-10 ***
Farm_TonsP.b             -0.001052   0.006363  -0.165 0.868694    
Tons_N_Rem.b             -0.010553   0.006306  -1.673 0.094634 .  
RatioP2O5.b              -0.072093   0.014254  -5.058 5.27e-07 ***
X21Crop_TotalPlantedAc.b -0.195587   0.077055  -2.538 0.011330 *  
X21Crop_TotalHarvestAc.b  0.378079   0.072863   5.189 2.69e-07 ***
TotalCropland.b          -0.152103   0.042174  -3.607 0.000330 ***
max.b                    -1.274018   0.301359  -4.228 2.64e-05 ***
heat.b                    2.930995   1.233555   2.376 0.017735 *  
precip.b                  0.263165   0.076656   3.433 0.000628 ***
sun.b                     0.752532   0.702074   1.072 0.284105    
day.b                    -0.080479   0.035252  -2.283 0.022697 *  
wheat_frac               -0.012252   0.001778  -6.889 1.14e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9389 on 793 degrees of freedom
  (3 observations deleted due to missingness)
Multiple R-squared:  0.3312,	Adjusted R-squared:  0.3211 
F-statistic: 32.72 on 12 and 793 DF,  p-value: < 2.2e-16
\end{Soutput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> full.frm1.pca.a <- paste("~ yield.a")
> for(trm in attr(full.best1$terms,"term.labels")) {
+    full.frm1.pca.a <- paste(full.frm1.pca.a,trm,sep=" + ")
+ }
> #full.best1.pca<-princomp(as.formula(full.frm1.pca.a),data=na.omit(full.covariates.dat),cor=TRUE)
> full.best1.pca<-princomp(as.formula(full.frm1.pca.a),data=full.covariates.dat,cor=TRUE)
> summary(full.best1.pca)
\end{Sinput}
\begin{Soutput}
Importance of components:
                         Comp.1    Comp.2    Comp.3     Comp.4    Comp.5
Standard deviation     2.152780 1.8228251 1.4261836 1.11087760 1.0862364
Proportion of Variance 0.243919 0.1748785 0.1070526 0.06494995 0.0621005
Cumulative Proportion  0.243919 0.4187975 0.5258501 0.59080002 0.6529005
                           Comp.6     Comp.7     Comp.8     Comp.9    Comp.10
Standard deviation     1.03046953 0.99743979 0.96771989 0.83569059 0.81041946
Proportion of Variance 0.05588776 0.05236243 0.04928851 0.03675678 0.03456735
Cumulative Proportion  0.70878828 0.76115071 0.81043922 0.84719600 0.88176335
                          Comp.11    Comp.12    Comp.13    Comp.14    Comp.15
Standard deviation     0.72743098 0.68657193 0.67419674 0.62070972 0.44440934
Proportion of Variance 0.02785031 0.02480953 0.02392322 0.02027792 0.01039472
Cumulative Proportion  0.90961366 0.93442318 0.95834641 0.97862433 0.98901905
                           Comp.16     Comp.17     Comp.18      Comp.19
Standard deviation     0.337299518 0.239635662 0.179166900 0.0730823620
Proportion of Variance 0.005987946 0.003022382 0.001689515 0.0002811069
Cumulative Proportion  0.995006997 0.998029378 0.999718893 1.0000000000
\end{Soutput}
\begin{Sinput}
> full.best1.pca$loadings
\end{Sinput}
\begin{Soutput}
Loadings:
                         Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7
yield.a                   0.190  0.272 -0.180        -0.113  0.322 -0.297
Farm_TonsK.a                            0.135 -0.266 -0.311 -0.443       
Tons_K2O_Exc.a                          0.177         0.208  0.663  0.330
Tons_N_Rem.a                           -0.111  0.664 -0.199        -0.323
RatioN.a                        -0.233 -0.176         0.515        -0.113
RatioP2O5.a                     -0.274 -0.247 -0.155  0.253        -0.480
N_PPCA.a                         0.354  0.239        -0.218  0.147       
FarmNPPCA.a                      0.314  0.164                      -0.472
FarmKPPCA.a                      0.411                                   
X21Crop_TotalPlantedAc.a  0.401         0.259  0.103  0.211 -0.158       
X21Crop_TotalHarvestAc.a  0.414         0.205         0.215 -0.152       
TotalCropland.a           0.380         0.247  0.126  0.208 -0.200  0.122
min.a                    -0.368         0.343  0.146  0.194 -0.118       
precip.a                 -0.186  0.407                0.258 -0.122       
sun.a                    -0.300 -0.188  0.414                      -0.134
day.a                    -0.267 -0.203  0.429                      -0.220
fine.a                   -0.170  0.369 -0.114  0.145  0.385 -0.221       
mean.income               0.332         0.211                0.215 -0.139
Tons_N_Fixed_Legumes.a           0.125  0.134 -0.578  0.206  0.107 -0.340
                         Comp.8 Comp.9 Comp.10 Comp.11 Comp.12 Comp.13 Comp.14
yield.a                          0.125 -0.213   0.466   0.150  -0.259   0.495 
Farm_TonsK.a              0.719        -0.184                  -0.208         
Tons_K2O_Exc.a            0.456 -0.383                                        
Tons_N_Rem.a                    -0.348 -0.386  -0.236           0.159  -0.180 
RatioN.a                  0.259  0.566 -0.267  -0.276  -0.256                 
RatioP2O5.a               0.182 -0.145  0.328           0.545   0.246         
N_PPCA.a                         0.311         -0.630   0.418           0.170 
FarmNPPCA.a                             0.593  -0.157  -0.490  -0.118         
FarmKPPCA.a               0.260  0.224 -0.104   0.310           0.724  -0.237 
X21Crop_TotalPlantedAc.a                                                      
X21Crop_TotalHarvestAc.a                                                      
TotalCropland.a                                                 0.125   0.205 
min.a                                                                         
precip.a                        -0.102                  0.289  -0.188         
sun.a                                           0.111           0.131   0.174 
day.a                                           0.214          -0.105         
fine.a                          -0.146                         -0.238  -0.161 
mean.income                      0.251          0.130   0.195  -0.321  -0.712 
Tons_N_Fixed_Legumes.a   -0.282 -0.334 -0.450  -0.168  -0.191                 
                         Comp.15 Comp.16 Comp.17 Comp.18 Comp.19
yield.a                  -0.123                                 
Farm_TonsK.a                                                    
Tons_K2O_Exc.a                                                  
Tons_N_Rem.a                                                    
RatioN.a                                                        
RatioP2O5.a              -0.132                                 
N_PPCA.a                 -0.153   0.106                         
FarmNPPCA.a                                                     
FarmKPPCA.a                                                     
X21Crop_TotalPlantedAc.a  0.149          -0.359  -0.108  -0.711 
X21Crop_TotalHarvestAc.a  0.101          -0.430           0.697 
TotalCropland.a          -0.175           0.740   0.166         
min.a                    -0.129  -0.142  -0.208   0.753         
precip.a                  0.709           0.249                 
sun.a                            -0.636          -0.436         
day.a                             0.721          -0.221         
fine.a                   -0.588                  -0.369         
mean.income                      -0.153   0.126                 
Tons_N_Fixed_Legumes.a                                          

               Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9
SS loadings     1.000  1.000  1.000  1.000  1.000  1.000  1.000  1.000  1.000
Proportion Var  0.053  0.053  0.053  0.053  0.053  0.053  0.053  0.053  0.053
Cumulative Var  0.053  0.105  0.158  0.211  0.263  0.316  0.368  0.421  0.474
               Comp.10 Comp.11 Comp.12 Comp.13 Comp.14 Comp.15 Comp.16 Comp.17
SS loadings      1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000
Proportion Var   0.053   0.053   0.053   0.053   0.053   0.053   0.053   0.053
Cumulative Var   0.526   0.579   0.632   0.684   0.737   0.789   0.842   0.895
               Comp.18 Comp.19
SS loadings      1.000   1.000
Proportion Var   0.053   0.053
Cumulative Var   0.947   1.000
\end{Soutput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> full.frm2.pca.b <- paste("~ yield.b")
> for(trm in attr(full.best2$terms,"term.labels")) {
+    full.frm2.pca.b <- paste(full.frm2.pca.b,trm,sep=" + ")
+ }
> full.best2.pca<-princomp(as.formula(full.frm2.pca.b),data=full.covariates.dat,cor=TRUE)
> summary(full.best2.pca)
\end{Sinput}
\begin{Soutput}
Importance of components:
                          Comp.1    Comp.2    Comp.3     Comp.4     Comp.5
Standard deviation     1.6486307 1.5416394 1.2127019 1.04979124 1.04465463
Proportion of Variance 0.2090756 0.1828194 0.1131266 0.08477397 0.08394641
Cumulative Proportion  0.2090756 0.3918950 0.5050216 0.58979557 0.67374198
                           Comp.6    Comp.7     Comp.8     Comp.9    Comp.10
Standard deviation     0.95403059 0.9315701 0.84527736 0.75562478 0.70118458
Proportion of Variance 0.07001341 0.0667556 0.05496106 0.04392068 0.03781999
Cumulative Proportion  0.74375540 0.8105110 0.86547206 0.90939274 0.94721273
                          Comp.11    Comp.12    Comp.13
Standard deviation     0.60059052 0.50335162 0.26863123
Proportion of Variance 0.02774684 0.01948945 0.00555098
Cumulative Proportion  0.97495957 0.99444902 1.00000000
\end{Soutput}
\begin{Sinput}
> full.best2.pca$loadings
\end{Sinput}
\begin{Soutput}
Loadings:
                         Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7
yield.b                  -0.303 -0.283  0.334                            
Farm_TonsP.b                    -0.102 -0.118         0.746  0.287  0.473
Tons_N_Rem.b                                  -0.541 -0.491  0.516  0.409
RatioP2O5.b               0.349 -0.193         0.117         0.270  0.113
X21Crop_TotalPlantedAc.b -0.128 -0.513 -0.387 -0.116 -0.102 -0.191       
X21Crop_TotalHarvestAc.b -0.147 -0.542 -0.300 -0.118        -0.173  0.124
TotalCropland.b                        -0.481 -0.330  0.172  0.319 -0.636
max.b                     0.376 -0.106 -0.224  0.416 -0.256  0.113       
heat.b                    0.204 -0.362  0.355        -0.112        -0.241
precip.b                 -0.473                                     0.163
sun.b                     0.483 -0.235  0.150 -0.124        -0.127       
day.b                     0.299         0.163 -0.600  0.209 -0.432       
wheat_frac                0.131  0.331 -0.407        -0.151 -0.427  0.290
                         Comp.8 Comp.9 Comp.10 Comp.11 Comp.12 Comp.13
yield.b                   0.198  0.626  0.509                         
Farm_TonsP.b              0.309 -0.111                                
Tons_N_Rem.b              0.145                                       
RatioP2O5.b              -0.761         0.309   0.109   0.199         
X21Crop_TotalPlantedAc.b               -0.136                   0.691 
X21Crop_TotalHarvestAc.b               -0.128                  -0.711 
TotalCropland.b                         0.317          -0.104         
max.b                     0.342         0.187  -0.595   0.176         
heat.b                    0.281 -0.561  0.201   0.365   0.231         
precip.b                 -0.209 -0.496  0.449  -0.412  -0.271         
sun.b                                                  -0.804         
day.b                                          -0.371   0.368         
wheat_frac                0.115         0.467   0.420                 

               Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9
SS loadings     1.000  1.000  1.000  1.000  1.000  1.000  1.000  1.000  1.000
Proportion Var  0.077  0.077  0.077  0.077  0.077  0.077  0.077  0.077  0.077
Cumulative Var  0.077  0.154  0.231  0.308  0.385  0.462  0.538  0.615  0.692
               Comp.10 Comp.11 Comp.12 Comp.13
SS loadings      1.000   1.000   1.000   1.000
Proportion Var   0.077   0.077   0.077   0.077
Cumulative Var   0.769   0.846   0.923   1.000
\end{Soutput}
\end{Schunk}



\begin{Schunk}
\begin{Sinput}
> PC1labels <- c("Yield Average","Wa","Wb","Wc","Wd","We","Ia","Ib","Ic","Id","Ie","If","Ig","Ih","Ii","Ij","Ik","Il","Im","In","In","Ua")
> xnames1 <- attr(full.best1.pca$scores,"dimnames")[[1]]
> for(idx in 1:length(xnames1)) {
+    xnames1[idx] = substr(xnames1[idx], 1, 2)
+ }
> xnames1[xnames1=="so"] <- "SD"
> xnames1[xnames1=="ka"] <- "KS"
> xnames1[xnames1=="no"] <- "ND"
> xnames1[xnames1=="te"] <- "TX"
> xnames1[xnames1=="ne"] <- "NE"
> xnames1[xnames1=="ok"] <- "OK"
> PC2labels <- c("Yield Change","W1","W2","W3","W4","W5","W6","I1","I2","I3","I4","I5","I6","I7","I8","U1","U2","U3")
> xnames2 <- attr(full.best2.pca$scores,"dimnames")[[1]]
> for(idx in 1:length(xnames2)) {
+    xnames2[idx] = substr(xnames2[idx], 1, 3)
+ }
> xnames2[xnames2=="so"] <- "SD"
> xnames2[xnames2=="ka"] <- "KS"
> xnames2[xnames2=="no"] <- "ND"
> xnames2[xnames2=="te"] <- "TX"
> xnames2[xnames2=="ne"] <- "NE"
> xnames2[xnames2=="ok"] <- "OK"
> xnames2[xnames2=="wa"] <- "WA"
> xnames2[xnames2=="or"] <- "OR"
> xnames2[xnames2=="id"] <- "ID"
> xnames2[xnames2=="mo"] <- "MT"
> xnames2[xnames2=="wy"] <- "WY"
> xnames2[xnames2=="ne"] <- "NM"
> xnames2[xnames2=="mi"] <- "MN"
> full.xnames2 <- attr(full.best2.pca$scores,"dimnames")[[1]]
> for(idx in 1:length(full.xnames2)) {
+    full.xnames2[idx] = substr(full.xnames2[idx], 1, 3)
+ }
> full.xnames2[full.xnames2=="sou"] <- "SD"
> full.xnames2[full.xnames2=="kan"] <- "KS"
> full.xnames2[full.xnames2=="nor"] <- "ND"
> full.xnames2[full.xnames2=="tex"] <- "TX"
> full.xnames2[full.xnames2=="neb"] <- "NE"
> full.xnames2[full.xnames2=="okl"] <- "OK"
> full.xnames2[full.xnames2=="was"] <- "WA"
> full.xnames2[full.xnames2=="ore"] <- "OR"
> full.xnames2[full.xnames2=="ida"] <- "ID"
> full.xnames2[full.xnames2=="mon"] <- "MT"
> full.xnames2[full.xnames2=="wyo"] <- "WY"
> full.xnames2[full.xnames2=="new"] <- "NM"
> full.xnames2[full.xnames2=="min"] <- "MN"
> full.xnames2[full.xnames2=="mis"] <- "MO"
> full.xnames2[full.xnames2=="iow"] <- "IA"
> full.xnames2[full.xnames2=="col"] <- "CO"
> all.PC1labels <- c("Yield","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W")
> full.PC2labels <-all.PC1labels[1:dim(full.best2.pca$loadings)[2]]
> full.PC1labels <-all.PC1labels[1:dim(full.best1.pca$loadings)[2]]
\end{Sinput}
\end{Schunk}


\begin{Schunk}
\begin{Sinput}
> par(mfrow=c(1,2))
> biplot(full.best1.pca,cex=c(.5,1),xlabs=full.xnames2,ylabs=full.PC1labels,col=cbbPalette[2:1])
> biplot(full.best2.pca,cex=c(.5,1),xlabs=full.xnames2,ylabs=full.PC2labels,col=cbbPalette[2:1])
> par(mfrow=c(1,1))
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-pca}

\begin{Schunk}
\begin{Sinput}
> par(bg="white")
> biplot(full.best1.pca,cex=c(.5,1),xlabs=full.xnames2,ylabs=full.PC1labels,col=cbbPalette[2:1])
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-pca1}

\begin{Schunk}
\begin{Sinput}
> par(bg="white")
> biplot(full.best2.pca,cex=c(.5,1),xlabs=full.xnames2,ylabs=full.PC2labels,col=cbbPalette[2:1])
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-pca2}



\begin{Schunk}
\begin{Sinput}
> common.scale <- max(abs(1.05*covariates.dat$yield.b))
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> setwd(current.wd)
> load(file="data/usda/early.lm.Rda")
> load(file="data/usda/mid.lm.Rda")
> rpn.mid.estimates <- extract.county.estimates(mid.lm,term=1)
> rpn.mid.year.estimates <- extract.county.estimates(mid.lm,term=2)
> common.scale <- max(c(common.scale, max(abs(1.05*rpn.mid.year.estimates))))
> rpn.early.estimates <- extract.county.estimates(early.lm,term=1)
> rpn.early.year.estimates <- extract.county.estimates(early.lm,term=2)
> #common.scale <- max(c(common.scale, max(abs(1.05*rpn.early.year.estimates))))
\end{Sinput}
\end{Schunk}



\begin{Schunk}
\begin{Sinput}
> par(bg="white")
> yield.b <- covariates.dat$yield.b
> names(yield.b) <- as.character(covariates.dat$statecounty)
> grid.arrange(arrangeGrob(
+    ggmap.values(rpn.early.year.estimates,names(rpn.early.year.estimates),main="Yield Change,1924-1944",legend="%/yr",palette=yield.palette),
+    ggmap.values(rpn.mid.year.estimates,names(rpn.mid.year.estimates),main="Yield Change,1944-1979",legend="%/yr",palette=yield.palette),
+    ggmap.values(yield.b,names(yield.b),main="Yield Change, 1984-2014 ",legend="%/yr",palette=yield.palette),
+    as.table=TRUE,
+    ncol=3))
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-077}

\begin{Schunk}
\begin{Sinput}
> setwd(current.wd)
> load(file="data/usda/early.full.lm.Rda")
> load(file="data/usda/mid.full.lm.Rda")
> full.mid.estimates <- extract.county.estimates(mid.full.lm,term=1)
> full.mid.year.estimates <- extract.county.estimates(mid.full.lm,term=2)
> full.early.estimates <- extract.county.estimates(early.full.lm,term=1)
> full.early.year.estimates <- extract.county.estimates(early.full.lm,term=2)
> #common.scale <- max(c(common.scale, max(abs(1.05*rpn.early.year.estimates))))
\end{Sinput}
\end{Schunk}



\begin{Schunk}
\begin{Sinput}
> full.yield.b <- full.covariates.dat$yield.b
> names(full.yield.b) <- as.character(full.covariates.dat$statecounty)
> grid.arrange(arrangeGrob(
+    ggmap.full.values(full.early.year.estimates,names(full.early.year.estimates),main="Yield Change,1924-1944",legend="%/yr",palette=yield.palette),
+    ggmap.full.values(full.mid.year.estimates,names(full.mid.year.estimates),main="Yield Change,1944-1979",legend="%/yr",palette=yield.palette),
+    ggmap.full.values(full.yield.b,names(full.yield.b),main="Yield Change, 1984-2014 ",legend="%/yr",palette=yield.palette),
+    as.table=TRUE,
+    ncol=3))
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-079}


\section{Offset}
\begin{Schunk}
\begin{Soutput}
                    statecounty  state  yield.a   yield.b Farm_TonsN.a
kansas,allen       kansas,allen kansas 34.14861 0.7210849      4736.76
kansas,anderson kansas,anderson kansas 38.24601 1.0649316      5351.04
kansas,atchison kansas,atchison kansas 38.40798 1.4899630      5078.64
kansas,barber     kansas,barber kansas 32.94516 0.1310829      4094.12
kansas,barton     kansas,barton kansas 35.31935 0.4753859      2577.92
kansas,bourbon   kansas,bourbon kansas 33.98710 1.6963269      2323.68
                Farm_TonsN.b Farm_TonsP.a Farm_TonsP.b Farm_TonsK.a
kansas,allen        1.492159      1413.60    -8.786078      1196.44
kansas,anderson     2.035492      1329.04     5.629627       765.20
kansas,atchison     1.394468       288.56     2.730801      3253.36
kansas,barber      -3.354567       877.00     6.396807      2595.36
kansas,barton     -10.145389      1464.64     4.855801      2914.28
kansas,bourbon     -1.319459      3377.24     2.588504      4017.60
                Farm_TonsK.b Tons_N_Exc.a Tons_N_Exc.b Tons_P2O5_Exc.a
kansas,allen       -8.130788       435.16   -2.7622024         2092.12
kansas,anderson     1.529012       963.40    1.0276105          351.64
kansas,atchison     2.135638       483.80   -0.5994212           71.04
kansas,barber       2.846619      1531.12   -4.7442395          692.76
kansas,barton       3.034712      3820.84    0.4820929         2540.72
kansas,bourbon      3.039128      1615.16    1.4165779          728.12
                Tons_P2O5_Exc.b Tons_K2O_Exc.a Tons_K2O_Exc.b
kansas,allen         11.1351165         329.24     -3.4260722
kansas,anderson       1.9394836         760.28      1.1890356
kansas,atchison      -0.2533784         374.40     -0.7478632
kansas,barber        -7.4369190        1249.12     -5.5911362
kansas,barton         0.7186939        3344.76      0.4747725
kansas,bourbon        2.9473164        1340.92      2.2790323
                Tons_N_Recovered.a Tons_N_Recovered.b Tons_P2O5_Recovered.a
kansas,allen               1781.04        -0.48735570               1525.32
kansas,anderson             632.76         0.15487705               1162.04
kansas,atchison            1869.96        -0.06524204                727.04
kansas,barber              1597.68         2.39972961               1146.04
kansas,barton               669.36       -11.37205689                417.08
kansas,bourbon             1709.92         0.56493871                895.12
                Tons_P2O5_Recovered.b Tons_K2O_Recovered.a Tons_K2O_Recovered.b
kansas,allen               6.34358692              1810.28           -0.3899949
kansas,anderson            0.11359334              2030.84            0.2077958
kansas,atchison           -0.03851232              1816.48           -0.1079010
kansas,barber              5.16735891              1905.48            3.8961312
kansas,barton              2.09552124               620.96            1.2851069
kansas,bourbon            -6.98677272              2203.52            0.4383895
                Tons_N_Fixed_Legumes.a Tons_N_Fixed_Legumes.b Tons_N_Rem.a
kansas,allen                   1767.84              -2.052222      5119.76
kansas,anderson                2312.36              -1.570690      6049.24
kansas,atchison                2113.84               2.035159      5761.76
kansas,barber                  2767.76              -4.592884      4482.04
kansas,barton                  3307.16               1.865044      3260.72
kansas,bourbon                  543.48              -3.893428      3854.56
                Tons_N_Rem.b Tons_P2O5_Rem.a Tons_P2O5_Rem.b Tons_K2O_Rem.a
kansas,allen      -0.3695486          533.40      -0.7311586        2179.40
kansas,anderson   -0.2608592         1097.52      -0.5776660        3043.52
kansas,atchison    1.1416650          958.16       3.3167738        2455.08
kansas,barber      0.3886623          509.24       0.9857827        1462.52
kansas,barton    -10.9282612         2838.44       1.3324220        5168.72
kansas,bourbon    -0.7269312         2187.08       3.7831264        2143.80
                Tons_K2O_Rem.b BalanceN_Tons.a BalanceN_Tons.b
kansas,allen        -0.4588419         3270.68       2.3982780
kansas,anderson     -0.7077332         3444.00       3.7979094
kansas,atchison      2.0422960         3298.52       1.6086002
kansas,barber        1.9801439         3616.36       3.2070922
kansas,barton        1.3709390         4045.16       3.7546104
kansas,bourbon       0.1679261         3931.12      -0.2884674
                BalanceP2O5_Tons.a BalanceP2O5_Tons.b BalanceK2O_Tons.a
kansas,allen               3350.68           2.203732           1134.32
kansas,anderson            3447.52           3.386782           1420.96
kansas,atchison            1243.16           2.105924           1108.40
kansas,barber              3380.92           3.249411           1955.68
kansas,barton              1634.56           7.523737           2599.44
kansas,bourbon             1637.88          -2.433634            864.76
                BalanceK2O_Tons.b RatioN.a   RatioN.b RatioP2O5.a RatioP2O5.b
kansas,allen             6.264546   0.6168 -1.3942931      0.8768  -4.6304745
kansas,anderson         -1.627069   0.6600 -1.9696970      0.8996  -5.3579369
kansas,atchison          3.311079   0.6616 -0.1813785      1.3748   0.9019494
kansas,barber           -1.455248   0.5308 -2.1853806      0.8128  -2.2883858
kansas,barton            1.501093   0.7264 -1.3491189      1.0552  -0.8908264
kansas,bourbon         -11.288681   0.8772  0.6383949      1.1832  -1.6396214
                RatioK2O.a  RatioK2O.b N_PPCA.a   N_PPCA.b P2O5_PPCA.a
kansas,allen        1.9168 -7.28297162  1222.48  2.3018781     1124.28
kansas,anderson     2.0796 -8.47278323  1104.00  3.4239130     1046.28
kansas,atchison     3.2048 -0.04992511  1246.16  1.2662900      274.08
kansas,barber       1.8768  1.56649616  1236.76  3.4266956      881.28
kansas,barton       3.2704  0.64823875   993.00 -0.9466264      262.96
kansas,bourbon      1.9364 -3.19148936  1071.32 -0.1997536      295.76
                P2O5_PPCA.b K2O_PPCA.a K2O_PPCA.b FarmNPPCA.a FarmNPPCA.b
kansas,allen       2.965453     308.72   7.242809     1305.92   1.7811198
kansas,anderson    5.661964     252.92  -0.767041     1234.48   2.0283844
kansas,atchison    2.057793     262.72   2.154385     1388.12   1.4379160
kansas,barber      7.516340     415.12   1.291193      943.28  -3.4517853
kansas,barton     10.868573     215.60   3.525046     1113.36   2.2256952
kansas,bourbon    -6.532324     266.60  -6.114029      848.28  -0.5257698
                FarmPPPCA.a FarmPPPCA.b FarmKPPCA.a FarmKPPCA.b
kansas,allen         390.28   -5.703597      466.48  -0.2272338
kansas,anderson      368.28   -5.664169      424.56  -0.6171095
kansas,atchison      171.12    2.197288      859.20   3.0144320
kansas,barber        211.92    6.304266      561.56   5.9263480
kansas,barton        303.92  -12.911292      217.76   7.4301984
kansas,bourbon       164.00  -21.463415       98.04 -15.4834761
                X21Crop_TotalPlantedAc.a X21Crop_TotalPlantedAc.b
kansas,allen                    165997.4              0.053374330
kansas,anderson                 198697.5             -0.009340833
kansas,atchison                 149521.6              0.555705664
kansas,barber                   183098.9             -0.362405275
kansas,barton                   348405.3              0.651614619
kansas,bourbon                  116960.5             -0.820755866
                X21Crop_TotalHarvestAc.a X21Crop_TotalHarvestAc.b
kansas,allen                    158919.9              0.208494998
kansas,anderson                 192963.4             -0.002342414
kansas,atchison                 145811.6              0.756469099
kansas,barber                   157691.0             -0.541108740
kansas,barton                   327876.9              0.499321514
kansas,bourbon                  113055.6             -0.670749851
                Total_Harvested_Cropland_Acres.a
kansas,allen                            158919.9
kansas,anderson                         193401.0
kansas,atchison                         147624.3
kansas,barber                           158470.8
kansas,barton                           330022.8
kansas,bourbon                          113055.6
                Total_Harvested_Cropland_Acres.b TotalCropland.a
kansas,allen                           0.2084950        174826.0
kansas,anderson                        0.0299895        230476.7
kansas,atchison                        0.7975246        172005.4
kansas,barber                         -0.4974418        214067.0
kansas,barton                          0.5502590        464006.7
kansas,bourbon                        -0.6707499        160644.5
                TotalCropland.b    min.a     min.b    max.a     max.b   heat.a
kansas,allen         -1.0917829 8.128251 0.2319564 19.24956 0.2495597 32.13516
kansas,anderson      -0.4356449 8.146259 0.2251250 18.87633 0.2206952 32.04761
kansas,atchison      -0.4683110 7.438233 0.1823599 17.80146 0.1953960 31.98970
kansas,barber        -1.0493348 9.334990 0.2131165 21.09026 0.2006303 31.69566
kansas,barton        -0.6851927 7.992459 0.3670674 19.72539 0.2512894 31.31916
kansas,bourbon       -0.8676675 8.369845 0.2308414 19.29956 0.2520020 32.24231
                     heat.b precip.a   precip.b    sun.a      sun.b    day.a
kansas,allen    0.083681378 2.996609 0.05564887 15994.25 0.06612004 23.77019
kansas,anderson 0.079259429 2.918247 0.14353001 15839.15 0.05052838 24.27539
kansas,atchison 0.117517792 2.620730 0.09125103 15481.19 0.06532118 24.84179
kansas,barber   0.006836987 2.033283 0.32721514 17148.63 0.09982335 26.66268
kansas,barton   0.073787056 1.888135 0.34292400 16680.82 0.04882431 28.64001
kansas,bourbon  0.105114480 3.163859 0.06125616 15904.82 0.07008877 22.84979
                      day.b  night.a    night.b    fine.a    fine.b harvested.a
kansas,allen    -0.81103984 6.576802  1.0929470 10.292167 -1.571719    30304.53
kansas,anderson -1.19531212 6.555881  0.4946486 10.889593 -1.907147    28254.58
kansas,atchison -2.14931639 5.919452 -1.0771588 11.270759 -1.947764    12918.01
kansas,barber   -0.01509154 6.810286  0.7523634  9.423741  1.189077   125134.19
kansas,barton   -2.04991297 5.644397  0.7689885  9.707741  1.597665   170187.10
kansas,bourbon  -0.36699300 6.607214  1.5578210 10.704204 -1.661082    12818.71
                harvested.b   acres.a   acres.b mean.income wheat_frac Latitude
kansas,allen     -1.0131423  32944.42 -1.240964   10578.333   19.06906 37.88290
kansas,anderson  -1.4358031  29970.94 -1.568737   22433.667   14.60933 38.21270
kansas,atchison  -5.4662423  14103.27 -5.837073   21322.667    8.75060 39.52878
kansas,barber    -1.1454799 145125.81 -1.322962   29374.333   78.96357 37.22484
kansas,barton    -0.5304409 186748.39 -0.837918   57050.667   51.56829 38.47496
kansas,bourbon   -3.2305350  14316.13 -3.616212    2716.667   11.33842 37.85487
                Longitude       coordname           I NearestStation  Distance
kansas,allen    -95.31793    kansas,allen -0.02876835  kansas,cowley 1.6677654
kansas,anderson -95.30444 kansas,anderson  0.08771093   kansas,riley 1.7935385
kansas,atchison -95.31737 kansas,atchison  0.25854664   kansas,riley 1.4404514
kansas,barber   -98.69329   kansas,barber  0.34519177    kansas,reno 0.9434182
kansas,barton   -98.75573   kansas,barton  0.02880725   kansas,ellis 0.7121488
kansas,bourbon  -94.85959  kansas,bourbon  0.08541192  kansas,cowley 2.0881399
                DistanceGPS
kansas,allen      1.6677654
kansas,anderson   1.7935385
kansas,atchison   1.4404514
kansas,barber     0.9434182
kansas,barton     0.7121488
kansas,bourbon    2.0881399
\end{Soutput}
\begin{Soutput}
                    statecounty  state  yield.a   yield.b Farm_TonsN.a
kansas,allen       kansas,allen kansas 32.90145 0.2433845    7716.6019
kansas,anderson kansas,anderson kansas 36.75584 0.9784542    9415.9179
kansas,atchison kansas,atchison kansas 36.61987 1.3100349    7863.3922
kansas,barber     kansas,barber kansas 33.80323 0.4832284   -2604.9504
kansas,barton     kansas,barton kansas 35.71935 0.6098167  -17682.4209
kansas,bourbon   kansas,bourbon kansas 32.77419 1.4452510    -311.2792
                Farm_TonsN.b Farm_TonsP.a Farm_TonsP.b Farm_TonsK.a
kansas,allen      0.01933700   -16132.198   0.05446299   -15040.744
kansas,anderson   0.02161757    12571.406   0.04478121     3818.637
kansas,atchison   0.01773367     5741.970   0.04755861     7518.230
kansas,barber     0.12877662    13651.424   0.04685817     8280.057
kansas,barton     0.05737556    11161.674   0.04350423     8974.600
kansas,bourbon    0.42388273     8546.483   0.03028736    10086.738
                Farm_TonsK.b Tons_N_Exc.a Tons_N_Exc.b Tons_P2O5_Exc.a
kansas,allen      0.05405842   -5080.9582   0.05436381      24328.9477
kansas,anderson   0.04004078    3015.5383   0.03407718       4224.7887
kansas,atchison   0.02840613    -713.2442   0.08404151       -434.9566
kansas,barber     0.03437921   -7943.1263   0.05972761     -14158.7672
kansas,barton     0.03381445    4783.5796   0.01007808       3975.9517
kansas,bourbon    0.03012994    4444.0661   0.03187572       6613.9108
                Tons_P2O5_Exc.b Tons_K2O_Exc.a Tons_K2O_Exc.b
kansas,allen         0.04576900      -6512.626     0.05260662
kansas,anderson      0.04590723       3134.784     0.03793038
kansas,atchison      0.05825371      -1119.083     0.06682823
kansas,barber        0.05252519      -9916.379     0.05638284
kansas,barton        0.01807602       4292.881     0.01105953
kansas,bourbon       0.04456238       5892.148     0.03867915
                Tons_N_Recovered.a Tons_N_Recovered.b Tons_P2O5_Recovered.a
kansas,allen              807.7907        -0.06033193            14193.4631
kansas,anderson           942.0495         0.01644044             1388.8859
kansas,atchison          1739.6717        -0.00375025              650.1309
kansas,barber            6389.9400         0.03755481            11465.2557
kansas,barton          -22040.6376         0.05159586             4601.8359
kansas,bourbon           2838.1026         0.01990551           -13057.4651
                Tons_P2O5_Recovered.b Tons_K2O_Recovered.a Tons_K2O_Recovered.b
kansas,allen              0.044693722             1031.460         -0.037809984
kansas,anderson           0.008178738             2445.808          0.008495997
kansas,atchison          -0.005923780             1601.002         -0.006739593
kansas,barber             0.045069722             9686.054          0.040224132
kansas,barton             0.045536635             3187.319          0.040319376
kansas,bourbon            0.053507880             3078.984          0.014238123
                Tons_N_Fixed_Legumes.a Tons_N_Fixed_Legumes.b Tons_N_Rem.a
kansas,allen                -2330.4472             0.08806129     4381.772
kansas,anderson              -824.3073             0.19054662     5528.304
kansas,atchison              6178.0521             0.03294175     8041.665
kansas,barber               -6404.2289             0.07171642     5258.199
kansas,barton                7031.6535             0.02652355   -18563.018
kansas,bourbon              -7231.6948             0.05383838     2402.878
                Tons_N_Rem.b Tons_P2O5_Rem.a Tons_P2O5_Rem.b Tons_K2O_Rem.a
kansas,allen    -0.008433771      -926.72373      0.07889715       1263.093
kansas,anderson -0.004718612       -56.07902      1.03009285       1630.177
kansas,atchison  0.014196874      7581.75731      0.04374677       6533.545
kansas,barber    0.007391549      2477.84812      0.03978382       5416.867
kansas,barton    0.058871146      5499.28680      0.02422900       7906.485
kansas,bourbon  -0.030252519      9741.98334      0.03883323       2479.148
                Tons_K2O_Rem.b BalanceN_Tons.a BalanceN_Tons.b
kansas,allen       -0.03632686        8060.041     0.029755158
kansas,anderson    -0.04341450       11028.425     0.034437459
kansas,atchison     0.03125862        6510.895     0.024706286
kansas,barber       0.03655515       10020.923     0.032003960
kansas,barton       0.01733942       11543.117     0.032526833
kansas,bourbon      0.00677354        3355.051    -0.008598005
                BalanceP2O5_Tons.a BalanceP2O5_Tons.b BalanceK2O_Tons.a
kansas,allen              7751.532         0.02842963        13644.6187
kansas,anderson          10210.924         0.03316822        -1828.2968
kansas,atchison           5448.689         0.03865009         7720.6248
kansas,barber             9869.995         0.03292212         -950.4509
kansas,barton            16659.463         0.04516194         5597.1218
kansas,bourbon           -3222.087         0.07552974       -21678.7365
                BalanceK2O_Tons.b   RatioN.a   RatioN.b RatioP2O5.a RatioP2O5.b
kansas,allen           0.04591221 -2783.7866 0.05008621   -9246.181  0.05007986
kansas,anderson        0.08899370 -3932.8248 0.05008352  -10698.900  0.05007932
kansas,atchison        0.04288615  -361.5512 0.05016674    1802.568  0.05003692
kansas,barber          0.15311137 -4363.6742 0.05008120   -4569.094  0.05008402
kansas,barton          0.02681901 -2693.4641 0.05008862   -1777.925  0.05010483
kansas,bourbon         0.05207260  1275.7518 0.05004068   -3273.141  0.05009321
                  RatioK2O.a RatioK2O.b  N_PPCA.a    N_PPCA.b P2O5_PPCA.a
kansas,allen    -14542.17752 0.05008171 5819.3307  0.03955572    7046.291
kansas,anderson -16918.06851 0.05008127 7941.5543  0.04311389   12353.223
kansas,atchison    -96.49565 0.05173820 3774.9412  0.03354463    4383.493
kansas,barber     3130.16964 0.05004509 8079.8710  0.04241028   15891.411
kansas,barton     1297.80318 0.04994893 -897.4129  0.10548393   21967.501
kansas,bourbon   -6371.46786 0.05009033  672.4121 -0.02970702  -12749.290
                P2O5_PPCA.b K2O_PPCA.a K2O_PPCA.b FarmNPPCA.a FarmNPPCA.b
kansas,allen     0.04208531  14772.610 0.04902864   4862.8163  0.03662733
kansas,anderson  0.04583390  -1278.861 0.05997846   5285.1637  0.03837884
kansas,atchison  0.04694414   4565.027 0.04719326   4259.6383  0.03375676
kansas,barber    0.04729813   2993.632 0.04313131  -5949.9352  0.05801383
kansas,barton    0.04947569   7255.118 0.04858703   5558.0733  0.04004437
kansas,bourbon   0.05123676 -11943.115 0.05119291   -201.6823  0.26069212
                FarmPPPCA.a FarmPPPCA.b FarmKPPCA.a FarmKPPCA.b
kansas,allen     -10999.804  0.05185181     12.6942 -1.79005964
kansas,anderson  -10943.065  0.05176035   -807.8076  0.07639312
kansas,atchison    4559.105  0.04819561   6879.0208  0.04382066
kansas,barber     12801.539  0.04924616  12396.4770  0.04780671
kansas,barton    -25479.931  0.05067240  15055.8662  0.04935085
kansas,bourbon   -42698.439  0.05026745 -30822.4618  0.05023439
                X21Crop_TotalPlantedAc.a X21Crop_TotalPlantedAc.b
kansas,allen                    166104.0             3.213308e-05
kansas,anderson                 198678.8            -4.701474e-06
kansas,atchison                 150631.3             3.689177e-04
kansas,barber                   182375.2            -1.987142e-04
kansas,barton                   349706.6             1.863318e-04
kansas,bourbon                  115321.4            -7.117115e-04
                X21Crop_TotalHarvestAc.a X21Crop_TotalHarvestAc.b
kansas,allen                    159336.2             1.308522e-04
kansas,anderson                 192958.7            -1.213946e-06
kansas,atchison                 147322.3             5.134790e-04
kansas,barber                   156610.4            -3.455125e-04
kansas,barton                   328874.1             1.518276e-04
kansas,bourbon                  111716.1            -6.004059e-04
                Total_Harvested_Cropland_Acres.a
kansas,allen                            159336.2
kansas,anderson                         193460.9
kansas,atchison                         149216.9
kansas,barber                           157477.4
kansas,barton                           331121.6
kansas,bourbon                          111716.1
                Total_Harvested_Cropland_Acres.b TotalCropland.a
kansas,allen                        1.308522e-04        172645.7
kansas,anderson                     1.550158e-05        229606.7
kansas,atchison                     5.344733e-04        171070.1
kansas,barber                      -3.158814e-04        211971.5
kansas,barton                       1.661803e-04        462638.4
kansas,bourbon                     -6.004059e-04        158911.7
                TotalCropland.b    min.a     min.b    max.a     max.b   heat.a
kansas,allen      -0.0006323836 8.061977 0.3067724 19.15215 0.2513245 32.12991
kansas,anderson   -0.0001897353 8.076653 0.3112488 18.77508 0.2410796 32.04368
kansas,atchison   -0.0002737538 7.365802 0.3121657 17.67756 0.2609510 31.96664
kansas,barber     -0.0004950358 9.243587 0.3306324 20.94582 0.2600553 31.68558
kansas,barton     -0.0001481054 7.870153 0.5396710 19.54822 0.3353694 31.31730
kansas,bourbon    -0.0005460059 8.302775 0.3030534 19.20019 0.2545984 32.22794
                    heat.b precip.a   precip.b    sun.a      sun.b        day.a
kansas,allen    0.05451480 2.993273 0.05571088 15973.09 0.06620760 -1595.876366
kansas,anderson 0.05111992 2.909870 0.14394322 15823.15 0.05057950 -2362.762924
kansas,atchison 0.08546167 2.615947 0.09141787 15460.97 0.06540663 -4267.343041
kansas,barber   0.01062153 2.019977 0.32937064 17114.40 0.10002304    -3.475124
kansas,barton   0.04591876 1.875185 0.34529218 16664.53 0.04887203 -4065.036199
kansas,bourbon  0.07244363 3.159983 0.06133130 15882.53 0.07018716  -710.035224
                     day.b    night.a    night.b    fine.a     fine.b
kansas,allen    0.05082097  2189.1919 0.04992468 -3128.430 0.05023985
kansas,anderson 0.05058959   994.3691 0.04974497 -3797.683 0.05021870
kansas,atchison 0.05036662 -2145.1668 0.05021329 -3878.414 0.05022063
kansas,barber   0.43427347  1509.2799 0.04984916  2384.011 0.04987717
kansas,barton   0.05042791  1541.3144 0.04989173  3200.246 0.04992321
kansas,bourbon  0.05168659  3117.5757 0.04996899 -3306.476 0.05023722
                harvested.a   harvested.b    acres.a       acres.b mean.income
kansas,allen      28281.283 -0.0035823774  30466.213 -0.0040732459   10578.333
kansas,anderson   25387.285 -0.0056555992  26838.172 -0.0058451704   22433.667
kansas,atchison    2001.925 -0.2730493748   2446.637 -0.2385753323   21322.667
kansas,barber    122846.670 -0.0009324469 142483.851 -0.0009284998   29374.333
kansas,barton    169127.806 -0.0003136332 185075.065 -0.0004527450   57050.667
kansas,bourbon     6367.331 -0.0507360912   7094.553 -0.0509716705    2716.667
                wheat_frac Latitude Longitude       coordname           I
kansas,allen      19.06906 37.88290 -95.31793    kansas,allen -0.02876835
kansas,anderson   14.60933 38.21270 -95.30444 kansas,anderson  0.08771093
kansas,atchison    8.75060 39.52878 -95.31737 kansas,atchison  0.25854664
kansas,barber     78.96357 37.22484 -98.69329   kansas,barber  0.34519177
kansas,barton     51.56829 38.47496 -98.75573   kansas,barton  0.02880725
kansas,bourbon    11.33842 37.85487 -94.85959  kansas,bourbon  0.08541192
                NearestStation  Distance DistanceGPS
kansas,allen     kansas,cowley 1.6677654   1.6677654
kansas,anderson   kansas,riley 1.7935385   1.7935385
kansas,atchison   kansas,riley 1.4404514   1.4404514
kansas,barber      kansas,reno 0.9434182   0.9434182
kansas,barton     kansas,ellis 0.7121488   0.7121488
kansas,bourbon   kansas,cowley 2.0881399   2.0881399
\end{Soutput}
\end{Schunk}


\begin{Schunk}
\begin{Sinput}
> best1.2 <- step(cov1.2.lm,direction = "both")
> best2.2 <- step(cov2.2.lm,direction = "both")
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> summary(aov(best1.2))
\end{Sinput}
\begin{Soutput}
                          Df Sum Sq Mean Sq F value   Pr(>F)    
BalanceK2O_Tons.a          1   1694    1694  144.22  < 2e-16 ***
RatioN.a                   1    121     121   10.30  0.00141 ** 
RatioP2O5.a                1   1812    1812  154.26  < 2e-16 ***
FarmNPPCA.a                1    748     748   63.70 8.83e-15 ***
FarmKPPCA.a                1    536     536   45.61 3.75e-11 ***
X21Crop_TotalPlantedAc.a   1   3629    3629  308.97  < 2e-16 ***
X21Crop_TotalHarvestAc.a   1   4278    4278  364.26  < 2e-16 ***
TotalCropland.a            1    503     503   42.85 1.38e-10 ***
min.a                      1   1468    1468  125.00  < 2e-16 ***
precip.a                   1    188     188   15.99 7.24e-05 ***
day.a                      1    599     599   50.98 3.05e-12 ***
fine.a                     1    382     382   32.53 1.94e-08 ***
acres.a                    1    237     237   20.16 8.72e-06 ***
mean.income                1   1275    1275  108.54  < 2e-16 ***
Distance                   1    400     400   34.09 9.12e-09 ***
Residuals                537   6307      12                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
\end{Soutput}
\begin{Sinput}
> summary(aov(best2.2))
\end{Sinput}
\begin{Soutput}
                                  Df Sum Sq Mean Sq F value   Pr(>F)    
N_PPCA.b                           1    0.6    0.58   0.877   0.3495    
X21Crop_TotalPlantedAc.b           1    1.7    1.73   2.617   0.1063    
X21Crop_TotalHarvestAc.b           1    0.1    0.09   0.130   0.7184    
Total_Harvested_Cropland_Acres.b   1    0.0    0.00   0.002   0.9671    
TotalCropland.b                    1    4.4    4.38   6.626   0.0103 *  
precip.b                           1   99.3   99.30 150.365  < 2e-16 ***
sun.b                              1    0.0    0.00   0.002   0.9643    
wheat_frac                         1   99.5   99.51 150.692  < 2e-16 ***
Distance                           1   22.8   22.84  34.584 7.14e-09 ***
Residuals                        543  358.6    0.66                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
\end{Soutput}
\begin{Sinput}
> cov1.4.lm <- lm(form1,data=na.omit(covariates4.dat))
> cov2.4.lm <- lm(form2,data=na.omit(covariates4.dat))
> 
> #summary(aov(cov3.4.lm))
> #summary(aov(cov4.4.lm))
\end{Sinput}
\end{Schunk}
\begin{Schunk}
\begin{Sinput}
> best1.4 <- step(cov1.4.lm,direction = "both")
> best2.4 <- step(cov2.4.lm,direction = "both")
\end{Sinput}
\end{Schunk}
\begin{Schunk}
\begin{Sinput}
> summary(aov(best1.4))
\end{Sinput}
\begin{Soutput}
                          Df Sum Sq Mean Sq F value   Pr(>F)    
Farm_TonsP.a               1     23      23   2.067 0.151145    
BalanceK2O_Tons.a          1   1395    1395 124.897  < 2e-16 ***
RatioN.a                   1     42      42   3.769 0.052726 .  
RatioP2O5.a                1   1709    1709 152.961  < 2e-16 ***
FarmNPPCA.a                1    615     615  55.040 4.67e-13 ***
FarmKPPCA.a                1    639     639  57.178 1.74e-13 ***
X21Crop_TotalPlantedAc.a   1   2831    2831 253.360  < 2e-16 ***
X21Crop_TotalHarvestAc.a   1   3545    3545 317.269  < 2e-16 ***
TotalCropland.a            1    447     447  39.974 5.43e-10 ***
min.a                      1   1141    1141 102.103  < 2e-16 ***
precip.a                   1    159     159  14.266 0.000177 ***
day.a                      1    555     555  49.688 5.58e-12 ***
fine.a                     1    482     482  43.184 1.18e-10 ***
harvested.a                1    237     237  21.171 5.25e-06 ***
acres.a                    1     14      14   1.288 0.256899    
mean.income                1   1292    1292 115.652  < 2e-16 ***
Distance                   1    265     265  23.760 1.44e-06 ***
Residuals                535   5977      11                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
\end{Soutput}
\begin{Sinput}
> summary(aov(best2.4))
\end{Sinput}
\begin{Soutput}
                                  Df Sum Sq Mean Sq F value   Pr(>F)    
X21Crop_TotalPlantedAc.b           1    0.9    0.88   1.457   0.2279    
X21Crop_TotalHarvestAc.b           1    0.1    0.07   0.114   0.7354    
Total_Harvested_Cropland_Acres.b   1    0.1    0.09   0.145   0.7030    
TotalCropland.b                    1    1.8    1.76   2.907   0.0888 .  
max.b                              1   42.0   42.00  69.257 7.01e-16 ***
precip.b                           1   49.2   49.17  81.081  < 2e-16 ***
wheat_frac                         1   64.2   64.21 105.874  < 2e-16 ***
Distance                           1   48.2   48.22  79.520  < 2e-16 ***
Residuals                        544  329.9    0.61                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
\end{Soutput}
\begin{Sinput}
> cov1.6.lm <- lm(form1,data=na.omit(covariates6.dat))
> cov2.6.lm <- lm(form2,data=na.omit(covariates6.dat))
> 
> #summary(aov(cov3.6.lm))
> #summary(aov(cov4.6.lm))
\end{Sinput}
\end{Schunk}
\begin{Schunk}
\begin{Sinput}
> best1.6 <- step(cov1.6.lm,direction = "both")
> best2.6 <- step(cov2.6.lm,direction = "both")
\end{Sinput}
\end{Schunk}
\begin{Schunk}
\begin{Sinput}
> summary(aov(best1.6))
\end{Sinput}
\begin{Soutput}
                          Df Sum Sq Mean Sq F value   Pr(>F)    
Farm_TonsP.a               1     14    14.3   1.317 0.251667    
Tons_N_Rem.a               1    125   124.7  11.512 0.000743 ***
BalanceK2O_Tons.a          1   1000  1000.2  92.325  < 2e-16 ***
RatioN.a                   1      1     1.4   0.133 0.714988    
RatioP2O5.a                1   1601  1601.4 147.829  < 2e-16 ***
K2O_PPCA.a                 1    236   236.4  21.818 3.80e-06 ***
FarmNPPCA.a                1    443   442.9  40.887 3.53e-10 ***
FarmKPPCA.a                1    832   832.3  76.828  < 2e-16 ***
X21Crop_TotalPlantedAc.a   1   2280  2280.2 210.483  < 2e-16 ***
X21Crop_TotalHarvestAc.a   1   2626  2626.0 242.406  < 2e-16 ***
TotalCropland.a            1    360   360.3  33.260 1.37e-08 ***
min.a                      1    787   787.4  72.684  < 2e-16 ***
precip.a                   1    274   274.4  25.332 6.61e-07 ***
day.a                      1    417   417.0  38.491 1.10e-09 ***
fine.a                     1    539   539.2  49.778 5.38e-12 ***
harvested.a                1    343   343.2  31.686 2.93e-08 ***
acres.a                    1     14    14.3   1.322 0.250670    
mean.income                1   1161  1160.6 107.138  < 2e-16 ***
Distance                   1    166   166.4  15.361 0.000100 ***
Residuals                533   5774    10.8                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
\end{Soutput}
\begin{Sinput}
> summary(aov(best2.6))
\end{Sinput}
\begin{Soutput}
                                  Df Sum Sq Mean Sq F value   Pr(>F)    
FarmNPPCA.b                        1    0.2    0.18   0.272 0.602377    
X21Crop_TotalPlantedAc.b           1    0.1    0.09   0.143 0.705331    
X21Crop_TotalHarvestAc.b           1    0.1    0.15   0.225 0.635244    
Total_Harvested_Cropland_Acres.b   1    0.2    0.15   0.233 0.629453    
max.b                              1    8.0    7.99  12.181 0.000522 ***
heat.b                             1   22.4   22.42  34.158 8.77e-09 ***
precip.b                           1   14.6   14.64  22.314 2.95e-06 ***
wheat_frac                         1   69.1   69.13 105.341  < 2e-16 ***
Distance                           1   43.2   43.24  65.894 3.21e-15 ***
Residuals                        543  356.3    0.66                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
\end{Soutput}
\end{Schunk}




\begin{Schunk}
\begin{Sinput}
> yield.b <- covariates.dat$yield.b
> names(yield.b) <- as.character(covariates.dat$statecounty)
> grid.arrange(arrangeGrob(
+    ggmap.values(covariates2.dat$yield.b,covariates2.dat$statecounty,main="Yield Change, 1982-2012",legend="%/yr",palette=yield.palette),
+    ggmap.values(covariates4.dat$yield.b,covariates4.dat$statecounty,main="Yield Change, 1980-2010",legend="%/yr",palette=yield.palette),
+    ggmap.values(covariates6.dat$yield.b,covariates6.dat$statecounty,main="Yield Change, 1978-2008",legend="%/yr",palette=yield.palette),
+    as.table=TRUE,
+    ncol=3))
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-088}

\begin{Schunk}
\begin{Sinput}
> yield.b.2 <- covariates2.dat$yield.b
> names(yield.b.2) <- covariates2.dat$statecounty
> yield.b.4 <- covariates4.dat$yield.b
> names(yield.b.4) <-covariates4.dat$statecounty
> yield.b.6 <- covariates6.dat$yield.b
> names(yield.b.6) <-covariates6.dat$statecounty
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> plot(covariates.dat$min.a,covariates2.dat$min.a,col="red")
> points(covariates.dat$min.a,covariates4.dat$min.a,col="blue")
> points(covariates.dat$min.a,covariates6.dat$min.a,col="green")
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-090}

\begin{Schunk}
\begin{Sinput}
> plot(covariates.dat$min.b,covariates2.dat$min.b,col="red")
> points(covariates.dat$min.b,covariates4.dat$min.b,col="blue")
> points(covariates.dat$min.b,covariates6.dat$min.b,col="green")
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-091}

\begin{Schunk}
\begin{Sinput}
> plot(covariates.dat$precip.b,covariates2.dat$precip.b,col="red")
> points(covariates.dat$precip.b,covariates4.dat$precip.b,col="blue")
> points(covariates.dat$precip.b,covariates6.dat$precip.b,col="green")
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-092}

\begin{Schunk}
\begin{Sinput}
> plot(covariates.dat$yield.b,yield.b.2[as.character(covariates.dat$statecounty)],col="red")
> points(covariates.dat$yield.b,yield.b.4[as.character(covariates.dat$statecounty)],col="blue")
> points(covariates.dat$yield.b,yield.b.6[as.character(covariates.dat$statecounty)],col="green")
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-093}







\begin{Schunk}
\begin{Sinput}
> setwd('data/usda')
> load.if.needed("county.late5.dat")
> load.if.needed("county.late10.dat")
> load.if.needed("county.late15.dat")
> setwd(current.wd)
> grid.arrange(arrangeGrob(
+   ggplot(county.late5.dat, aes(Year,Value)) + geom_point(aes(color=State)) + geom_smooth(aes(group=State),weight=10,se = FALSE,method="lm"),
+   ggplot(county.late10.dat, aes(Year,Value)) + geom_point(aes(color=State)) + geom_smooth(aes(group=State),weight=10,se = FALSE,method="lm"),
+   ggplot(county.late15.dat, aes(Year,Value)) + geom_point(aes(color=State)) + geom_smooth(aes(group=State),weight=10,se = FALSE,method="lm"),
+    as.table=TRUE,
+    ncol=3))
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> setwd('data/usda')
> load.if.needed("late5.county.lm")
> load.if.needed("late10.county.lm")
> load.if.needed("late15.county.lm")
> setwd(current.wd)
> yield5.b <- extract.county.estimates(late5.county.lm,term=2)[coef.idx]
> yield10.b <- extract.county.estimates(late10.county.lm,term=2)[coef.idx]
> yield15.b <- extract.county.estimates(late15.county.lm,term=2)[coef.idx]
> grid.arrange(arrangeGrob(
+    ggmap.values(yield15.b,names(yield15.b ),main="Yield Change, 1969-1999",legend="%/yr",palette=yield.palette),
+    ggmap.values(yield10.b,names(yield10.b),main="Yield Change, 1974-2004",legend="%/yr",palette=yield.palette),
+    ggmap.values(yield5.b,names(yield5.b),main="Yield Change, 1979-2009",legend="%/yr",palette=yield.palette),
+    as.table=TRUE,
+    ncol=3))
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-095}


\begin{Schunk}
\begin{Sinput}
> setwd('data/usda')
> load.if.needed("full.late5.dat")
> load.if.needed("full.late10.dat")
> load.if.needed("full.late15.dat")
> setwd(current.wd)
> grid.arrange(arrangeGrob(
+   ggplot(full.late5.dat, aes(Year,Value)) + geom_point(aes(color=State)) + geom_smooth(aes(group=State),weight=10,se = FALSE,method="lm"),
+   ggplot(full.late10.dat, aes(Year,Value)) + geom_point(aes(color=State)) + geom_smooth(aes(group=State),weight=10,se = FALSE,method="lm"),
+   ggplot(full.late15.dat, aes(Year,Value)) + geom_point(aes(color=State)) + geom_smooth(aes(group=State),weight=10,se = FALSE,method="lm"),
+    as.table=TRUE,
+    ncol=3))
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> setwd('data/usda')
> load.if.needed("late5.full.lm")
> load.if.needed("late10.full.lm")
> load.if.needed("late15.full.lm")
> setwd(current.wd)
> yield5.b <- extract.county.estimates(late5.full.lm,term=2)[full.coef.idx]
> yield10.b <- extract.county.estimates(late10.full.lm,term=2)[full.coef.idx]
> yield15.b <- extract.county.estimates(late15.full.lm,term=2)[full.coef.idx]
> grid.arrange(arrangeGrob(
+    ggmap.full.values(yield15.b,names(yield15.b ),main="Yield Change, 1969-1999",legend="%/yr",palette=yield.palette),
+    ggmap.full.values(yield10.b,names(yield10.b),main="Yield Change, 1974-2004",legend="%/yr",palette=yield.palette),
+    ggmap.full.values(yield5.b,names(yield5.b),main="Yield Change, 1979-2009",legend="%/yr",palette=yield.palette),
+    as.table=TRUE,
+    ncol=3))
\end{Sinput}
\end{Schunk}
\includegraphics{WheatYields-097}


Climate Data Online
http://www.ncdc.noaa.gov/cdo-web/
Submitted query by searching for SD
1984-2014
Monthly summary
Summary is limited to 5000 location years, this is 27,712 Station Years, so must include multiple stations per county (66)



Other data from USDA
at state level,
Fertilizer and with limited years

Plant Available Water from USDA NASS? See Clay's paper in Global Food Security

### Quickstats Lite
Gives different options, more columns at one time.

http://www.nass.usda.gov/Quick_Stats/Lite/









Aquifer Data
 USGS High Plains Water-Level Monitoring Study
http://ne.water.usgs.gov/ogw/hpwlms/data.html
County and state level data, downloaded as individual files

HWW RPN
http://www.ars.usda.gov/Main/docs.htm?docid=11932

References

ray.d-12-2012
- yield unchanging, stagnating, collapsing, increasing.
ray.d-2013
cites yield increases in ND, SD, based on crop census reports 1989-2008


clay.d-01-2014
Show yield gaps w.r.t. corn in SD

Wheat Yields
graybosch.r-2014

Wheat Yields in France
brisson.n-10-2010

Periods in yields
thompson.l-01-1988

Small yield gains in corn
farfan.i-2013

Europe
moore.f-03-2015

Open Data
carolan.l-2015

brklacich.m-1995
CERES-wheat model in Canada





\end{document}

